<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>Blueschisting</title><link href="/" rel="alternate"></link><link href="/feeds/all.atom.xml" rel="self"></link><id>/</id><updated>2018-04-24T00:00:00-07:00</updated><entry><title>Buses are bosons, or How I learned to stop worrying and love AC Transit (Part two)</title><link href="/bus-bunching-2.html" rel="alternate"></link><published>2018-04-24T00:00:00-07:00</published><updated>2018-04-24T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2018-04-24:/bus-bunching-2.html</id><summary type="html">&lt;p&gt;&lt;img alt="bunch" src="/articles/transit/images/6-bunch.jpg"&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;img alt="6-bunch" src="articles/transit/images/6-bunch.jpg" title="Bunching on the 6 bus line in Oakland"&gt;&lt;/p&gt;
&lt;p&gt;This is the second and final part of a short series of articles
on constructing a mathematical model for why buses always seem to travel in packs
(known as bus bunching).&lt;/p&gt;
&lt;p&gt;In the &lt;a href="bus-bunching-1.html"&gt;previous article&lt;/a&gt;
we set up the model, consisting of &lt;span class="math"&gt;\(N\)&lt;/span&gt; buses traveling on a loop,
where we parameterized the position of the &lt;span class="math"&gt;\(n\)&lt;/span&gt;th bus by &lt;span class="math"&gt;\(\theta_n\)&lt;/span&gt;.
We presumed that a bus is slowed down by the boarding of passengers,
and that more passengers will need to board if it has been longer
since the last bus came along, an effect given by a parameter &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The equations for this model are given by
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d\theta_n}{d t} = 
 v_0 \left[ 1 - \gamma (\theta_{n+1} - \theta_n) \right]
\label{evolution}
\end{equation}&lt;/div&gt;
&lt;p&gt;We furthermore showed that the equilibrium configuration for a set of &lt;span class="math"&gt;\(N\)&lt;/span&gt; buses
is for them to be equally spaced along the route, traveling at a velocity of &lt;span class="math"&gt;\(v_e\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
v_e = v_0 \left[ 1 - \frac{2 \pi \gamma}{N} \right]
\label{equilibrium}
\end{equation}&lt;/div&gt;
&lt;p&gt;In system with five buses, and in reference frame traveling at a velocity of &lt;span class="math"&gt;\(v_e\)&lt;/span&gt;,
this equilibrium solution looks like this:
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=false&amp;equilibrium=true&amp;boost=true&amp;gamma=0.15&amp;n=5 width=700 height=700&gt;&lt;/iframe&gt;&lt;/p&gt;
&lt;p&gt;In this article we will demonstrating that this equilibrium solution is not stable,
and that it will inevitably result in the buses bunching.&lt;/p&gt;
&lt;h2&gt;Stability analysis&lt;/h2&gt;
&lt;p&gt;Most stability analyses are centered on answering a central question:
is my equilibrium solution stable with respect to small perturbations?
That is to say, if I have an equilibrium solution and poke it slightly,
does it return to equilibrium, or does that poke keep growing until the solution
is no longer anything like the equilibrium one?
&lt;img alt="stability" src="articles/transit/images/stability.png" title="Illustration of stability"&gt;
This behavior can be visualized by thinking of a ball balanced on a hill,
and another resting in a trough.
Both of the balls are not moving around, and are thus in equilibrium solutions.
However, if I nudge the ball on the hill, it will continue rolling until it is far from the peak.
If I nudge the ball in the trough, it will roll back to the middle and
eventually come to a rest.
The first situation is an unstable equilibrium, and the second is a stable one.&lt;/p&gt;
&lt;p&gt;Our approach for analyzing the system of equations in equation \eqref{evolution} will be similar:
we will investigate its behavior when we nudge it slightly away from the equilibrium solution
represented by equation \eqref{equilibrium}.
If those nudges grow in time, it is unstable.
If they die off in time, it is stable.&lt;/p&gt;
&lt;h2&gt;Perturbation equations&lt;/h2&gt;
&lt;p&gt;The first step in deriving the perturbation equations is to split the
bus positions &lt;span class="math"&gt;\(\theta_n(t)\)&lt;/span&gt; into two parts, an equilibrium part and a perturbation:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\theta_n = \theta^e_n + \theta^\prime_n
\label{decompose}
\end{equation}&lt;/div&gt;
&lt;p&gt;In equation \eqref{decompose}, &lt;span class="math"&gt;\(\theta^e_n\)&lt;/span&gt; is the equilibrium solution for the buses
(i.e. &lt;span class="math"&gt;\(v_e\)&lt;/span&gt; integrated with respect to time),
and &lt;span class="math"&gt;\(\theta^\prime_n\)&lt;/span&gt; is a small perturbation away from that equilibrium.
You may wonder what the perturbation actually &lt;em&gt;is&lt;/em&gt;, since it can be a function of time,
and each of the buses can have a different perturbation.
Fortunately, we will be able to show that this analysis does not depend on the form
of the perturbation (other than that it is nonzero), so it can be completely arbitrary.&lt;/p&gt;
&lt;p&gt;The governing equations are in terms of velocities rather than positions,
so we take the time derivative of equation \eqref{decompose},
noting that &lt;span class="math"&gt;\(d \theta^e_n / dt = v^e\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \theta_n}{dt} = \frac{d \theta^e_n}{dt} + \frac{d \theta^\prime_n}{dt} = v_e + \frac{d \theta^\prime_n}{dt}
\label{decompose2}
\end{equation}&lt;/div&gt;
&lt;p&gt;We can substitute equations \eqref{decompose} and \eqref{decompose2}
into equation \eqref{evolution} to get
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \theta^\prime_n}{dt} + v_e = 
v_0 \left[ 1 - \gamma (\theta^e_{n+1} - \theta^e_n) - \gamma(\theta^\prime_{n+1} - \theta^\prime_n) \right]
\end{equation}&lt;/div&gt;
&lt;p&gt;
Note that in the equilibrium configuration the buses are equally spaced,
so &lt;span class="math"&gt;\(\theta^e_{n+1} - \theta^e_{n} = 2 \pi / N\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \theta^\prime_n}{dt} + v_e = 
v_0 \left[ 1 - \frac{2 \pi \gamma}{N}  - \gamma(\theta^\prime_{n+1} - \theta^\prime_n) \right]
\end{equation}&lt;/div&gt;
&lt;p&gt;This allows &lt;span class="math"&gt;\(v_e\)&lt;/span&gt; to be subtracted from both sides, leaving us with:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \theta^\prime_n}{dt} = 
v_0 \gamma(\theta^\prime_{n} - \theta^\prime_{n+1})
\label{perturb}
\end{equation}&lt;/div&gt;
&lt;p&gt;Okay, so what did those manipulations buy us?
There are two attractive features that equation \eqref{perturb} has:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;It is now a system of differential equations involving only the perturbations,
the time evolution of which we are interested in for the stability problem.
The equilibrium solution has completely disappeared.&lt;/li&gt;
&lt;li&gt;More importantly, &lt;em&gt;it is now a system of linear equations!&lt;/em&gt;
There are no nonlinearities or constant offsets getting in our way.
And if there is one thing mathematics is good at analyzing, it is linear equations.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In fact, since it is a set of linear equations,
we can write it using matrix notation:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \Theta^\prime}{d t} = 
\mathbf{A}\Theta^\prime
\label{matrix}
\end{equation}&lt;/div&gt;
&lt;p&gt;
where &lt;span class="math"&gt;\(\Theta^\prime\)&lt;/span&gt; is a vector containing all the perturbations to the &lt;span class="math"&gt;\(N\)&lt;/span&gt; buses,
and &lt;span class="math"&gt;\(\mathbf{A}\)&lt;/span&gt; is a matrix describing the linear coupling between the buses, given by:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\mathbf{A} = 
v_0 \gamma 
\begin{bmatrix}
1 &amp;amp; -1 &amp;amp; 0 &amp;amp; 0 &amp;amp; \ldots &amp;amp; 0 \\
0 &amp;amp; 1 &amp;amp; -1 &amp;amp; 0 &amp;amp; \ldots &amp;amp; 0 \\
0 &amp;amp; 0 &amp;amp; 1 &amp;amp; -1 &amp;amp; \ldots &amp;amp; 0 \\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; \ddots &amp;amp; \vdots \\
-1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \ldots &amp;amp; 1\\
\end{bmatrix}
\label{A}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Note that the last row couples the speed of the &lt;span class="math"&gt;\(N\)&lt;/span&gt;th bus to the first bus,
reflecting the circular nature of the model.&lt;/p&gt;
&lt;h2&gt;The eigendecomposition&lt;/h2&gt;
&lt;p&gt;When analyzing a system of linear equations,
it is often helpful consider it in terms of its eigenvalues and eigenvectors
(exactly how it is helpful should be clearer in a moment).
A general perturbation vector &lt;span class="math"&gt;\(\Theta^\prime\)&lt;/span&gt; can be decomposed
into a linear combination of the &lt;span class="math"&gt;\(N\)&lt;/span&gt; eigenvectors of &lt;span class="math"&gt;\(\mathbf{A}\)&lt;/span&gt;
(known as an &lt;a href="https://en.wikipedia.org/wiki/Eigenvalues_and_eigenvectors#Eigenspaces,_geometric_multiplicity,_and_the_eigenbasis_for_matrices"&gt;eigendecomposition&lt;/a&gt;):
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\Theta^\prime(t) = \sum_k a_k(t) \Theta^\prime_k
\label{eigs}
\end{equation}&lt;/div&gt;
&lt;p&gt;
where &lt;span class="math"&gt;\(a_k(t)\)&lt;/span&gt; is the amount of that each eigenvector &lt;span class="math"&gt;\(\Theta^\prime_k\)&lt;/span&gt;
contributes to the total perturbation &lt;span class="math"&gt;\(\Theta^\prime_k(t)\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;Substituting equation \eqref{eigs} into \eqref{matrix}, we get
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\sum_k \frac{d a_k}{dt} \Theta^\prime_k = 
\sum_k a_k \mathbf{A}\Theta^\prime_k = 
\sum_k a_k \lambda_k \Theta^\prime_k
\end{equation}&lt;/div&gt;
&lt;p&gt;
where we have used the definition of the eigenvalues &lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt;:
&lt;span class="math"&gt;\(\mathbf{A}\Theta^\prime_k = \lambda_k \Theta^\prime_k\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The eigenvectors of &lt;span class="math"&gt;\(\mathbf{A}\)&lt;/span&gt; are linearly independent,
so the components of the summation decouple,
giving us a set of independent ordinary differential equations:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d a_k}{d t} = 
\lambda_k a_k
\label{diff_eigen}
\end{equation}&lt;/div&gt;
&lt;p&gt;Equation \eqref{diff_eigen} looks very much like equation \eqref{matrix},
but with one important difference:
It is now a scalar equation for the time evolution of &lt;span class="math"&gt;\(a_k\)&lt;/span&gt;.
In fact, it the solution of this ordinary differential equation is among the
first that students of calculus learn to find: an exponential:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
a_k(t) = a_k(0) e^{\lambda_k t}
\label{integrated}
\end{equation}&lt;/div&gt;
&lt;h2&gt;A hunt for eigenvalues&lt;/h2&gt;
&lt;p&gt;Equation \eqref{integrated} gives us the solution for the
time evolution of the perturbations of &lt;span class="math"&gt;\(\mathbf{A}\)&lt;/span&gt;.
Remember, our perturbation to the equilibrium solution can be written
as a combination of the eigenvectors, and we are interested in whether
the perturbation grows in time or shrinks in time.
The answer to that question all comes down to the values for the eigenvalues &lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt;.
Broadly speaking, there are three possibilities:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt; is negative. In this case, a perturbation of the shape of &lt;span class="math"&gt;\(\Theta^\prime_k\)&lt;/span&gt;
will shrink in time, since \eqref{integrated} is a negative exponential.&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt; is positive. In this case, a perturbation of the shape of &lt;span class="math"&gt;\(\Theta^\prime_k\)&lt;/span&gt;
will grow in time, since \eqref{integrated} is a positive exponential.&lt;/li&gt;
&lt;li&gt;&lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt; is complex. In this case, a perturbation of the shape of &lt;span class="math"&gt;\(\Theta^\prime_k\)&lt;/span&gt;
will have combined behaviors: it will oscillate according to the imaginary part
of &lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt; (due to &lt;a href="https://en.wikipedia.org/wiki/Euler%27s_formula"&gt;Euler's formula&lt;/a&gt;),
and either shrink or grow according to the sign of the real part.
For our purposes, we want to know it shrinks or grows,
so we are most interested in the real part of any complex eigenvalues.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;In physical systems, there is always a certain amount of noise,
and in general that noise will put some amount of power
into each of the eigenvectors of the system.
Some eigenvectors might get a bit more power, some might get a bit less,
but for random, uncorrelated noise, we expect all the eigenvectors to get some.
This means that if &lt;em&gt;just one&lt;/em&gt; eigenvalue has a positive real part,
then the power in that eigenvalue will blow up.
Therefore our stability metric is this: &lt;em&gt;all&lt;/em&gt; of the eigenvalues must have
negative real parts for the system to be considered stable to perturbations.&lt;/p&gt;
&lt;p&gt;So let's find the eigenvalues of &lt;span class="math"&gt;\(\mathbf{A}\)&lt;/span&gt;.
Usually calculating the eigenvalues of a matrix of a larger order than 2 or 3
is a pretty involved process, but in this case the matrix is
ordered enough, and has enough zeroes in it, that we can come up
with a closed-form solution.&lt;/p&gt;
&lt;p&gt;The eigenvalues of &lt;span class="math"&gt;\(\mathbf{A}\)&lt;/span&gt; can be found by solving its
&lt;a href="https://en.wikipedia.org/wiki/Characteristic_polynomial"&gt;characteristic polynomial&lt;/a&gt;,
found by taking the determinant of &lt;span class="math"&gt;\(\mathbf{A} - \lambda \mathbf{I}\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
det(\mathbf{A - \lambda \mathbf{I}}) = 
(v_0 \gamma)^N 
\begin{vmatrix}
1-\lambda &amp;amp; -1 &amp;amp; 0 &amp;amp; 0 &amp;amp; \ldots &amp;amp; 0 \\
0 &amp;amp; 1-\lambda &amp;amp; -1 &amp;amp; 0 &amp;amp; \ldots &amp;amp; 0 \\
0 &amp;amp; 0 &amp;amp; 1-\lambda &amp;amp; -1 &amp;amp; \ldots &amp;amp; 0 \\
\vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; \vdots &amp;amp; \ddots &amp;amp; \vdots \\
-1 &amp;amp; 0 &amp;amp; 0 &amp;amp; 0 &amp;amp; \ldots &amp;amp; 1-\lambda\\
\end{vmatrix}
\end{equation}&lt;/div&gt;
&lt;p&gt;We apply the &lt;a href="https://en.wikipedia.org/wiki/Laplace_expansion"&gt;Laplace expansion&lt;/a&gt;
(where I have elided some steps):
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
det(\mathbf{A} - \lambda \mathbf{I}) = 
(v_0 \gamma)^N \left[ (1-\lambda)^N + (-1)(-1)^{N+1}(-1)^{N-1} \right] = 0
\end{equation}&lt;/div&gt;
&lt;p&gt;which may be simplified to&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
(1-\lambda)^N = 1
\end{equation}&lt;/div&gt;
&lt;p&gt;Now, this polynomial equation of order &lt;span class="math"&gt;\(N\)&lt;/span&gt; has a fairly straightforward set
of solutions for &lt;span class="math"&gt;\(\lambda\)&lt;/span&gt;: they are the
&lt;a href="https://en.wikipedia.org/wiki/Root_of_unity"&gt;roots of unity&lt;/a&gt;,
shifted along the positive &lt;span class="math"&gt;\(x\)&lt;/span&gt;-axis by one.&lt;/p&gt;
&lt;p&gt;We can write the solution for &lt;span class="math"&gt;\(\lambda_k\)&lt;/span&gt; explicitly
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\lambda_k = e^{\frac{2 k \pi i}{N}} + 1 = \cos \frac{2 k \pi}{N} + i \sin \frac{2 k \pi}{N} + 1
\end{equation}&lt;/div&gt;
&lt;p&gt;
which, when plotted (for &lt;span class="math"&gt;\(N=10\)&lt;/span&gt;), gives the following:&lt;/p&gt;
&lt;p&gt;&lt;img alt="roots_of_unity" src="articles/transit/images/roots_of_unity.png" title="Eigenvalues of the stability problem"&gt;&lt;/p&gt;
&lt;p&gt;Hey, look at that! The real part of each eigenvalue is greater than zero!&lt;sup id="fnref-1"&gt;&lt;a class="footnote-ref" href="#fn-1"&gt;1&lt;/a&gt;&lt;/sup&gt;
That is to say, not only is the system unstable, it is &lt;em&gt;wildly&lt;/em&gt; unstable.
Remember, the system is unstable if if &lt;em&gt;just one&lt;/em&gt; of the eigenvalues has a positive real part.&lt;/p&gt;
&lt;h2&gt;Simulating bus bunching&lt;/h2&gt;
&lt;p&gt;That was a long way to go,
but by determining that the eigenvalues of the system of equations \eqref{perturb}
all have nonnegative real parts, we determined that any perturbation
to our equilibrium solution is unstable.
Therefore, if any of the buses on our bus route get slightly off schedule,
they will continue to get further and further off schedule.&lt;/p&gt;
&lt;p&gt;Let's close out the article with some interactive simulations of bus bunching.
The simulations start with a number of buses in the equilibrium configuration,
but as you will see, they soon drift away from that equilibrium, and once they
start to drift, bunching is inevitable.&lt;/p&gt;
&lt;p&gt;There are two versions of the simulation: one in the &lt;span class="math"&gt;\(v_e\)&lt;/span&gt; reference frame,
where we see the velocities of the buses relative to their equilibrium velocity,
and one in the street frame, where we see the velocities of the buses relative to the road.&lt;/p&gt;
&lt;p&gt;In the &lt;span class="math"&gt;\(v_e\)&lt;/span&gt; reference frame:
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=true&amp;equilibrium=false&amp;boost=true&amp;gamma=0.15&amp;n=5 width=700 height=700&gt;&lt;/iframe&gt;&lt;/p&gt;
&lt;p&gt;In the street reference frame:
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=true&amp;equilibrium=false&amp;boost=false&amp;gamma=0.15&amp;n=5 width=700 height=700&gt;&lt;/iframe&gt;&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;The model we analyzed here was probably about as simple as it could be
while still exhibiting bunching behavior. We used a simplified geometry,
and it really only had two parameters (&lt;span class="math"&gt;\(v_0\)&lt;/span&gt;, the speed in the absence of passengers,
and &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt;, the amount by which passenger boarding slows it down).
Nevertheless, it demonstrates a plausible mechanism for an all-too familiar
occurrence for transit riders.&lt;/p&gt;
&lt;p&gt;The good news is that actual bus system behavior can be more complex than this
simple model: it has drivers, schedulers, and real-time information.
It is possible to design things to mitigate the essential bunchiness of a route.
Things like &lt;a href="https://thesource.metro.net/2017/10/14/all-door-boarding-proposed-for-720-and-754-rapid-lines/"&gt;streamlined passenger boarding&lt;/a&gt;,
&lt;a href="https://en.wikipedia.org/wiki/Bus_priority"&gt;signal priority&lt;/a&gt;,
and layovers all likely have a role in mitigating bunching.&lt;/p&gt;
&lt;p&gt;So what's the moral here? I'd like to say that you shouldn't feel frustrated
the next time a pack of buses roll up to your stop, but that's probably not realistic.
Instead, maybe just look at them with grim recognition.&lt;/p&gt;
&lt;p&gt;&lt;img alt="18-bunch" src="articles/transit/images/18-bunch.jpg" title="Bunching on the 18 bus line in Albany"&gt;&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn-1"&gt;
&lt;p&gt;Strictly speaking, there is a single eigenvalue that is equal to zero, 
when &lt;span class="math"&gt;\(k=N\)&lt;/span&gt;. You can verify manually that this corresponds to an eigenvector
where each bus is perturbed by the same amount (a &lt;span class="math"&gt;\(\mathbf{1}\)&lt;/span&gt; vector).
A perturbation of this form is marginally stable (neither stable nor unstable),
since none of the buses get any closer to or further from each other.
For the pedantic, you can replace of my statements about all eigenvegors 
being unstable with "all eigenvectors but one are unstable".&amp;#160;&lt;a class="footnote-backref" href="#fnref-1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Buses are bosons, or How I learned to stop worrying and love AC Transit (Part one)</title><link href="/bus-bunching-1.html" rel="alternate"></link><published>2018-03-19T00:00:00-07:00</published><updated>2018-03-19T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2018-03-19:/bus-bunching-1.html</id><summary type="html">&lt;p&gt;&lt;img alt="bunch" src="/articles/transit/images/18-bunch.jpg"&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;If you have spent any amount of time using mass transit,
you know the frustration of waiting for the better part of an hour for a bus to arrive,
only to see two or three of them roll up in quick succession.
This phenomenon is a common enough problem that it has a name: "bus bunching":&lt;/p&gt;
&lt;p&gt;&lt;img alt="18-bunch2" src="articles/transit/images/18-bunch2.jpg" title="Bunching on the 18 bus line in Berkeley"&gt;&lt;/p&gt;
&lt;p&gt;In this two-part series, we'll investigate bus bunching by making a mathematical model of a bus route.
In this first part, we'll construct the model and find it's equilibrium solution.
In the second part, we'll demonstrate the inevitability for that model to bunch.&lt;/p&gt;
&lt;p&gt;Let's start by constructing a model for the speed of a single bus.
We will assume that the bus has a fixed route, on which it travels all day.
That route may be on any number of different streets, go wending through different
neighborhoods, and generally make very little sense 
(like my beloved &lt;a href="http://www.actransit.org/pdf/maps/version_38/12.pdf"&gt;12 line&lt;/a&gt;).
However, if it travels back and forth on this same route, we can model it as a loop,
and its position on that loop can be mapped to an angle on a circle &lt;span class="math"&gt;\(\theta\)&lt;/span&gt;.
We can then identify the speed of the bus with the time derivative of &lt;span class="math"&gt;\(\theta\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;The simplest model for &lt;span class="math"&gt;\(d\theta/ dt\)&lt;/span&gt; is for the bus to travel at a constant speed &lt;span class="math"&gt;\(v_0\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \theta}{d t} = v_0
\end{equation}&lt;/div&gt;
&lt;p&gt;
Or, expressed in a simulation:
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=false&amp;boost=false&amp;equilibrium=true&amp;gamma=0&amp;n=1 width=700 height=700&gt;&lt;/iframe&gt;&lt;/p&gt;
&lt;p&gt;Now, this model isn't very interesting.
There is only a single bus, and it is traveling at a fixed speed,
so it has no hope of exhibiting the kind of bunching behavior that we want to explain.&lt;/p&gt;
&lt;p&gt;A typical mass transit route operates multiple buses with a given
&lt;a href="https://en.wikipedia.org/wiki/Headway"&gt;headway&lt;/a&gt;,
the distance (or time) between successive vehicles on the route.
If everything is operating according to the plan,
the headway from one bus to the next should be approximately constant,
with possible scheduled variations depending on the time of day
(such as increased frequency during rush hour, or decreased frequency at night).&lt;/p&gt;
&lt;p&gt;We can increase the complexity of our model adding some more buses so that there are &lt;span class="math"&gt;\(N\)&lt;/span&gt; on the route:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \theta_n}{d t} = v_0
\label{constant}
\end{equation}&lt;/div&gt;
&lt;p&gt;In this equation the subscript indicates the &lt;span class="math"&gt;\(n\)&lt;/span&gt;th bus out of &lt;span class="math"&gt;\(N\)&lt;/span&gt;,
so a simulation with five buses looks like this:
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=false&amp;equilibrium=true&amp;boost=false&amp;gamma=0&amp;n=5 width=700 height=700&gt;&lt;/iframe&gt;
Okay, so this is starting to more closely resemble a bus route.
However, the buses are still moving at a constant speed, and have no effect on each other.
In order for our model to exhibit the richer characteristics of a system that can bunch,
there must be some way for their speed to be a function of conditions on the road.&lt;/p&gt;
&lt;p&gt;There are many factors that can control the speed of a bus traveling through town,
including traffic, construction, scheduled layovers, and the number of passengers.
In order to keep the model simple, we will focus on the last factor:
the number of passengers who board and exit the bus.
A traveling bus constantly picks up and drops off passengers as it makes its way around its route.
This process takes time (as anyone who has watched a passenger fumble with change upon boarding knows).
A bus that boards and deposits more passengers will, in general, make slower progress along its route.&lt;/p&gt;
&lt;p&gt;Many things affect the number of passengers boarding a given bus, 
including time-of-day, scheduling, and population density.
In order to keep the model as simple as possible, we will ignore those and
concentrate on a single factor: the amount of time since the previous bus.
We will assume that as more time passes, more passengers arrive at a bus stop for pickup.
If a bus falls behind schedule, more people will have arrived at each stop,
meaning that it will be further slowed down by the excess passengers.
In the following analysis, we will use the distance between buses as a proxy
for the number of passengers that need to be picked up.&lt;/p&gt;
&lt;p&gt;We need to augment our model to account for this slowing-down behavior.
The expression for speed in equation \eqref{constant} is a constant,
so the next-simplest expression is to make it linear in the distance between buses
(our proxy for the number of passengers):
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d\theta_n}{d t} = 
 v_0 \left[ 1 - \gamma (\theta_{n+1} - \theta_n) \right]
\label{evolution}
\end{equation}&lt;/div&gt;
&lt;p&gt;In this equation, a bus picking up &lt;em&gt;no&lt;/em&gt; passengers travels at &lt;span class="math"&gt;\(v_0\)&lt;/span&gt;
(which happens if there has been no time for them to accumulate since the previous bus).
As the distance between a bus and the one ahead of it increases,
the speed of the bus slows down, reflecting the additional time spent boarding and disembarking.
The dimensionless parameter &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt; determines how sensitive the bus speeds are to differences in headway.&lt;/p&gt;
&lt;p&gt;Equation \eqref{evolution} is a set of ordinary differential equations
(one equation for each of the &lt;span class="math"&gt;\(N\)&lt;/span&gt; buses).
It will be the primary  evolution equation for our system of buses,
which we will analyze by answering the following two questions.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Is there an equilibrium solution to these equations?
That is to say, is there a solution that does not evolve in time?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;If there is an equilibrium solution, is it stable?
A stable solution, when perturbed, will return to the equilibrium.
An unstable one will get further and further from equilibrium until the buses are bunched.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Strictly speaking, an equilibrium solution does not exist for the system of equations as described:
as long as the buses have a nonzero velocity, their positions will evolve in time.
However, with a slight reframing of the question it makes sense to talk about an equilibrium:
is there a configuration for which the bus velocities are constant,
and that the distance between them (headways) are not changing?&lt;/p&gt;
&lt;p&gt;In a coordinate system traveling with the buses at equilibrium speed
the solution to the system would then look like this:&lt;/p&gt;
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=false&amp;equilibrium=true&amp;boost=true&amp;gamma=0&amp;n=5 width=700 height=700&gt;&lt;/iframe&gt;

&lt;p&gt;It seems intuitive that an equilibrium solution, if it exists,
should have the buses equally spaced, so let's start looking for a solution of that form.
Let's further guess that the equilibrium velocity is the base bus speed &lt;span class="math"&gt;\(v_0\)&lt;/span&gt;.
A change of coordinates makes this system a bit easier to reason about.
Let's boost ourselves into moving a coordinate system &lt;span class="math"&gt;\(\psi\)&lt;/span&gt;, defined by:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\psi_n \equiv \theta_n - v_0 t
\end{equation}&lt;/div&gt;
&lt;p&gt;From this we can also get the relations
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d\theta_n}{d t} =
\frac{d \psi_n}{d t} + v_0
\end{equation}&lt;/div&gt;
&lt;div class="math"&gt;\begin{equation}
\theta_n =
\psi_n + v_0 t
\end{equation}&lt;/div&gt;
&lt;p&gt;Substituting these into equation \eqref{evolution},
we get the governing equations in terms of &lt;span class="math"&gt;\(\psi_n\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \psi_n}{d t} + v_0 = 
v_0 \left[ 1 - \gamma (\psi_{n+1} - \psi_n) \right]
\end{equation}&lt;/div&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \psi_n}{d t} = 
v_0 \gamma (\psi_{n} - \psi_{n+1})
\end{equation}&lt;/div&gt;
&lt;p&gt;When the buses are equally spaced around the loop, then the distance
between them is the whole loop length divided between the number of buses, or
&lt;span class="math"&gt;\(\psi_{n+1} - \psi_n = 2 \pi/N\)&lt;/span&gt;,
which makes the governing equations in the &lt;span class="math"&gt;\(\psi\)&lt;/span&gt; coordinates&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \psi_n}{d t} = 
\frac{ 2 \pi v_0 \gamma }{N}
\end{equation}&lt;/div&gt;
&lt;p&gt;Unless the interaction term &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt; is zero, the time evolution of &lt;span class="math"&gt;\(\psi_n\)&lt;/span&gt; is nonzero,
making this configuration a non-equilibrium solution to the system.
Therefore, &lt;span class="math"&gt;\(v_0\)&lt;/span&gt; is &lt;em&gt;not&lt;/em&gt; the equilibrium velocity.&lt;/p&gt;
&lt;p&gt;This should make sense, as we defined &lt;span class="math"&gt;\(v_0\)&lt;/span&gt; to be the speed of the bus
in the absence of any delays due to loading and unloading of passengers.
When we include that delay, the buses will be slower.
Instead, let's construct a speed for buses that takes into account the
delay due to passengers.&lt;/p&gt;
&lt;p&gt;Again we presume that the buses are equally spaced,
such that the distance between them is &lt;span class="math"&gt;\(2 \pi/N\)&lt;/span&gt;.
Then, given the evolution equation \eqref{evolution}, we can calculate the speed &lt;span class="math"&gt;\(v_e\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
v_e = \frac{d \theta_n}{d_t} = v_0 \left[ 1 - \frac{2 \pi \gamma}{N} \right]
\end{equation}&lt;/div&gt;
&lt;p&gt;
Let's boost into a &lt;em&gt;new&lt;/em&gt; coordinate system &lt;span class="math"&gt;\(\phi\)&lt;/span&gt;, defined by
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\phi_n \equiv \theta_n - v_e t
\end{equation}&lt;/div&gt;
&lt;p&gt;Substituting this into equation \eqref{evolution}, we find&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \phi_n}{d t} + v_e =
v_0 \left[ 1 - \gamma \left(\phi_{n+1} - \phi_n \right) \right]
\end{equation}&lt;/div&gt;
&lt;p&gt;
As before, when the buses are equally spaced, &lt;span class="math"&gt;\(\phi_{n+1} - \phi_n = 2 \pi/N\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \phi_n}{d t} + v_e =
v_0 \left[ 1 - \frac{2 \pi \gamma}{N}  \right]
\end{equation}&lt;/div&gt;
&lt;p&gt;The right-hand-side is exactly &lt;span class="math"&gt;\(v_e\)&lt;/span&gt;, so we can subtract it from both sides to get&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{d \phi_n}{d t} = 0
\end{equation}&lt;/div&gt;
&lt;p&gt;
This is exactly what we wanted: in the &lt;span class="math"&gt;\(\phi\)&lt;/span&gt; coordinate system,
the positions of the buses are constant in time, so
equally-spaced buses are all in equilibrium.&lt;/p&gt;
&lt;p&gt;In order to get a feel for the equilibrium solution,
you can experiment with this interactive simulation, which shows the buses
traveling at their equilibrium speed and spacing
(in the &lt;span class="math"&gt;\(\phi\)&lt;/span&gt; coordinate system that moves with them).&lt;/p&gt;
&lt;iframe src=/visualization/bus/bus-bunching.html?interactive=true&amp;equilibrium=true&amp;boost=true&amp;gamma=0.15&amp;n=5 width=700 height=700&gt;&lt;/iframe&gt;

&lt;p&gt;You can see that as the number of buses increases and the headway between the buses gets smaller,
the equilibrium speed increases, reflecting the decreased number of passengers each has to pick up.&lt;/p&gt;
&lt;p&gt;At this point we have answered the first of the two above questions: there is an equilibrium solution.
In the next installment of this series, we are going to answer the second question:
is this equilibrium solution stable? (Spoiler: it's not.)&lt;/p&gt;
&lt;p&gt;&lt;img alt="streetcar" src="/articles/transit/images/streetcar-bunch.jpg" title="New Orleans streetcars can be bunched too"&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Mapping California Cities</title><link href="/mapping-california-cities.html" rel="alternate"></link><published>2018-02-08T00:00:00-08:00</published><updated>2018-02-08T00:00:00-08:00</updated><author><name>Ian Rose</name></author><id>tag:None,2018-02-08:/mapping-california-cities.html</id><summary type="html">&lt;p&gt;&lt;img alt="la_cities" src="/articles/coding/images/la_cities_small.png"&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;TL;DR: We are making these maps:&lt;/p&gt;
&lt;p&gt;&lt;img alt="los-angeles" src="/articles/coding/images/la_cities_small.png"&gt;
&lt;img alt="bay-area" src="/articles/coding/images/bay_area_cities_small.png"&gt;&lt;/p&gt;
&lt;p&gt;A couple of weeks ago a colleague told me that she was moving out of Oakland, California,
to a city on the San Francisco peninsula called San Carlos.
I had been a resident of the Bay Area for most of my life,
and consider myself reasonably geographically aware, and I had never heard of San Carlos.&lt;/p&gt;
&lt;p&gt;That sent me down a rabbit hole of trying to find a political map of the Bay Area
that showed all of the incorporated municipalities. The Wikipedia article on the
&lt;a href="https://en.wikipedia.org/wiki/San_Francisco_Bay_Area#Government_and_politics"&gt;Bay Area&lt;/a&gt;
claims that there are 101 cities and towns within the nine counties that make up
the larger metropolitan area. Surprisingly, I was
&lt;a href="https://www.google.com/search?q=map+of+bay+area+cities&amp;amp;client=ubuntu&amp;amp;hs=BWu&amp;amp;channel=fs&amp;amp;source=lnms&amp;amp;tbm=isch&amp;amp;sa=X&amp;amp;ved=0ahUKEwjo-ImVhZfZAhVJ0WMKHbw1DoUQ_AUICigB&amp;amp;biw=1472&amp;amp;bih=722"&gt;unable&lt;/a&gt;
to come up with a map that actually showed those cities and their boundaries,
or really anything close to that.&lt;/p&gt;
&lt;p&gt;Meanwhile, I moved to Los Angeles. This is a new metropolitan area to me,
and I am much less familiar with the patchwork of cities that comprise it.
Again, I tried to find a map that showed these cities. I had a bit more success
(&lt;a href="http://www.laalmanac.com/geography/ge30ba.php"&gt;this&lt;/a&gt; map gets pretty close),
but still was missing some of the information that I wanted.&lt;/p&gt;
&lt;p&gt;So, like any self-respecting geologist, I set out to make the maps I wanted.
These maps would do the following:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Show the incorporated municipalities in the metropolitan area.
No counties, no parks, no neighborhoods, no unincorporated areas,
no &lt;a href="https://en.wikipedia.org/wiki/Census-designated_place"&gt;census-designated places&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Show some of the physiography of the area. The placement and shape of human settlements
are controlled by oceans, rivers, hills, and mountains.
I find it annoying and confusing to look at maps that omit these,
as the pattern of settlement winds up looking much more random than it actually is.&lt;/li&gt;
&lt;li&gt;Be somewhat nice to look at.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So, let's get started. I'll use the LA area as an example here, I used
essentially the same code to generate the high-resolution map of the Bay Area.&lt;/p&gt;
&lt;h1&gt;Acquiring the data&lt;/h1&gt;
&lt;p&gt;To begin, we need to download the data, both political and physical.&lt;/p&gt;
&lt;h2&gt;Political data&lt;/h2&gt;
&lt;p&gt;The biggest source of open mapping data comes from the
&lt;a href="https://www.openstreetmap.org"&gt;OpenStreetMap&lt;/a&gt; community.
They have a truly staggering amount of data that is reasonably up-to-date.&lt;/p&gt;
&lt;p&gt;The downside of this is that the data is so vast that it becomes difficult
to download and parse. &lt;a href="http://extract.bbbike.org/"&gt;This&lt;/a&gt; website was useful
to me in constructing the request for downloading a subset of the OSM data
(in this case, a box around the LA metropolitan area).&lt;/p&gt;
&lt;p&gt;The data is downloaded in an large binary database, which you then need to
query for the data you want. There are a number of OSM readers available:
I chose to use the &lt;a href="http://www.gdal.org/"&gt;Geospatial Data Abstraction Library (GDAL)&lt;/a&gt;,
which has the ability to read and transform vector and raster GIS data
in just about any format.&lt;/p&gt;
&lt;p&gt;The extract of all Southern California vector data is about 1 GB in size,
but we can extract the subset we are interested using a SQL-ish command
line argument for the GDAL program &lt;code&gt;ogr2ogr&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ogr2ogr -sql &lt;span class="s2"&gt;&amp;quot;SELECT * FROM multipolygons WHERE admin_level=&amp;#39;8&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
        -f &lt;span class="s2"&gt;&amp;quot;ESRI Shapefile&amp;quot;&lt;/span&gt; data/la_cities data/los_angeles.osm.pbf
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;This command selects from the database all of the multipolygons
(your basic GIS data structure for shapes, including city borders)
where the &lt;code&gt;admin_level&lt;/code&gt; property is set to &lt;code&gt;'8'&lt;/code&gt;, indicating a municipality.
The output format is set to &lt;a href="https://www.esri.com/library/whitepapers/pdfs/shapefile.pdf"&gt;ESRI Shapefile&lt;/a&gt;,
and the data is placed in the &lt;code&gt;la_cities&lt;/code&gt; directory.&lt;/p&gt;
&lt;p&gt;We will also have need for the populations of the cities, which is
located in the same database, but in a different table.
The following command extracts those populations, and stores them
in a GeoJSON file &lt;code&gt;la_cities.geojson&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ogr2ogr -sql &lt;span class="s2"&gt;&amp;quot;SELECT * FROM points WHERE population IS NOT NULL and name IS NOT NULL&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
        -f &lt;span class="s2"&gt;&amp;quot;GeoJSON&amp;quot;&lt;/span&gt; data/la_cities.geojson data/los_angeles.osm.pbf
&lt;/pre&gt;&lt;/div&gt;


&lt;h2&gt;Physical data&lt;/h2&gt;
&lt;p&gt;We will use elevation data from NASA to construct the physiographic part of the map.
The &lt;a href="https://www2.jpl.nasa.gov/srtm/"&gt;Shuttle Radar Topography Mission&lt;/a&gt; generated
worldwide topography data at 10 meter resolution, which is good enough to make
a very attractive map. Unfortunately, the data is a bit tricky to download, and
the NASA website itself has a lot of dead links. &lt;a href="http://dwtkns.com/srtm30m/"&gt;This&lt;/a&gt;
website provided a much better interface for downloading the same underlying data.&lt;/p&gt;
&lt;p&gt;The data is, by default, downloadable in 1 degree by 1 degree chunks.
We can stich them together into one GeoTiff using the GDAL command-line tool &lt;code&gt;gdal_merge.py&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;gdal_merge.py -o data/socal.tif -of png data/N3?W1??.hgt
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once the physical and political data are downloaded and preprocessed,
we are ready to start making the map!&lt;/p&gt;
&lt;h1&gt;Plotting the terrain&lt;/h1&gt;
&lt;p&gt;We can load the raw elevation data into our Python session using GDAL,
and then plot it using the mapping library &lt;a href="http://scitools.org.uk/cartopy/"&gt;cartopy&lt;/a&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;gdal&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.pyplot&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;plt&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;cartopy.crs&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;ccrs&lt;/span&gt;

&lt;span class="c1"&gt;# Load the data&lt;/span&gt;
&lt;span class="n"&gt;socal&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;gdal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/socal.tif&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;z_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socal&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ReadAsArray&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the data&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;
&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;120.0001389&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;32.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;35.0001389&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;gist_gray&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_elev.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="socal_elev" src="/articles/coding/images/socal_elev.png"&gt;&lt;/p&gt;
&lt;p&gt;Okay, so this does indeed show the topography of the LA metro area.
The San Gabriel Mountains are in the bright spot in the center,
the Santa Monica Mountains/Hollywood Hills are to the southwest of them.
The Palos Verdes peninsula is visible to the south of those, and Catalina
Island can be seen at the bottom.&lt;/p&gt;
&lt;p&gt;However, this image doesn't really pop. It turns out that
visualization of topography works better with what is known as hillshading.
This takes elevation data and shades it as if a light were shining on the
slopes (usually with some vertical exaggeration). The resulting lumination
map makes it much clearer to the human eye.
Thankfully, matplotlib contains an illumination tool that does the job for us:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.colors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LightSource&lt;/span&gt;

&lt;span class="c1"&gt;# Generate the hillshaded intensity&lt;/span&gt;
&lt;span class="n"&gt;ls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LightSource&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;intensity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;hillshade&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;vert_exag&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the intensity&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;intensity&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;gist_gray&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_hillshade.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="socal_hillshade" src="/articles/coding/images/socal_hillshade.png"&gt;&lt;/p&gt;
&lt;p&gt;Much better! We can much more easily see the topographic features of the region,
including the coastal plain, the San Fernando and San Gabriel Valleys, and the San
Andreas fault.&lt;/p&gt;
&lt;p&gt;Finally, it would be nice to have the water show up as blue.
We can do this by making a masked array for where the elevation is zero,
and color that blue:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy.ma&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;ma&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;numpy&lt;/span&gt; &lt;span class="kn"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;np&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;matplotlib.colors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;

&lt;span class="c1"&gt;# Construct a mask for water&lt;/span&gt;
&lt;span class="n"&gt;water&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ma&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;masked_where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z_data&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ones_like&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;z_data&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="c1"&gt;# Set up the axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the hillshade&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;intensity&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;gist_gray&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;#Make a pure blue colormap, and plot the water mask&lt;/span&gt;
&lt;span class="n"&gt;cm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;water&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="mi"&gt;169&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;204&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;227&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;169&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;204&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;227&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;water&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_hillshade_water.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="socal_hillshade" src="/articles/coding/images/socal_hillshade_water.png"&gt;
Okay, &lt;em&gt;this&lt;/em&gt; is something we can work with.&lt;/p&gt;
&lt;h1&gt;Plotting the cities&lt;/h1&gt;
&lt;h2&gt;Drawing shapes&lt;/h2&gt;
&lt;p&gt;Unlike the above, which was raster data, the city boundaries are vector data,
and require a different pipeline for plotting them.
We have already preprocessed the data into shapefiles above, for which cartopy has a reader.&lt;/p&gt;
&lt;p&gt;We can loop over the entries in the shapefiles and plot them by running the following:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;cartopy.io&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;shapereader&lt;/span&gt;
&lt;span class="n"&gt;reader&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;shapereader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Reader&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/la_cities/multipolygons.shp&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Set up the map axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the shapes in the database&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_geometries&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; 
                      &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_cities.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="los-angeles-monochrome" src="/articles/coding/images/socal_cities.png"&gt;&lt;/p&gt;
&lt;p&gt;This map isn't terrible, but it is awfully monochromatic.
We would like to have a map where the cities colored so that
it is easier to distinguish them.&lt;/p&gt;
&lt;h2&gt;Assigning colors&lt;/h2&gt;
&lt;p&gt;Let's start by getting a qualitative colormap from the great
&lt;a href="http://colorbrewer2.org/#type=qualitative&amp;amp;scheme=Set1&amp;amp;n=6"&gt;ColorBrewer&lt;/a&gt;,
and cycling throught them to assign colors to the map.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;cycle&lt;/span&gt;

&lt;span class="c1"&gt;# Create the color cycle&lt;/span&gt;
&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#e41a1c&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#377eb8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#4daf4a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#984ea3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#ff7f00&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#ffff33&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;colorcycle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cycle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Set up the map axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the city shapes&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_geometries&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;next&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colorcycle&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                      &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_cities_color.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="los-angeles-color" src="/articles/coding/images/socal_cities_color.png"&gt;&lt;/p&gt;
&lt;p&gt;This is looking much better! However, if you look closely,
you can see that there are many places where neighboring cities
have been assigned the same color, which looks kind of funky,
and makes the boundaries between them difficult to spot.
We would like to set it up so that neighboring cities are not the same color.&lt;/p&gt;
&lt;p&gt;As it happens, this problem is a classic one in graph theory, known
as &lt;a href="https://en.wikipedia.org/wiki/Graph_coloring"&gt;graph coloring&lt;/a&gt;. One of
the most famous theorems in mathematics is the 
&lt;a href="https://en.wikipedia.org/wiki/Four_color_theorem"&gt;four color theorem&lt;/a&gt;,
which (roughly) states that you can color a map so that no regions have a
neighbor of the same color using only four colors. This theorem was among
the first to be proved using a computer.&lt;/p&gt;
&lt;p&gt;For our purposes, we can come up with a map coloring somewhat more easily
by using more colors than four (six, in our case), and applying a
&lt;a href="https://en.wikipedia.org/wiki/Greedy_algorithm"&gt;greedy algorithm&lt;/a&gt;.
The algorithm goes as follows:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Compute the neighbors of each city by checking whether their boundaries intersect.&lt;/li&gt;
&lt;li&gt;Sort the cities in order of having the most neighbors to the least.&lt;/li&gt;
&lt;li&gt;Iterate through the list of cities in order. For each city pick a color that none of its neighbors are currently assigned.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;As long as we have enough colors, we should be able to finds a coloring that
works using this algorithm.
We can check the intersection of two boundaries using the &lt;code&gt;intersects()&lt;/code&gt;
function on the shapefile geometries.
The following function accomplishes that,
along with sorting the resulting dictionary:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;collections&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;generate_intersections&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Make a dictionary to store the neighbors list of each city&lt;/span&gt;
    &lt;span class="n"&gt;intersections&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Iterate over the cities&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;city1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="n"&gt;name1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;city1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attributes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="c1"&gt;# Break early if there is an invalid or duplicate name&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;name1&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;continue&lt;/span&gt;
        &lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="c1"&gt;# Check if each other city intersects the current one&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;city2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="n"&gt;name2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;city2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attributes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="c1"&gt;# Break early if there is an invalid or duplicate name&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;name1&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;name2&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;city1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;intersects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;city2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{name1} intersects {name2}&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# Once we have the intersections dictionary, sort them from most to least neighbors&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;OrderedDict&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; \
           &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;intersections&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Once we have the ordered neighbors map from &lt;code&gt;generate_intersections()&lt;/code&gt;,
we can apply the greedy color assignment (step 3):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;random&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;greedy_coloring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;neighbors_map&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Make a dictionary for storing the city colors&lt;/span&gt;
    &lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# For this each city, try to find a color&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;city&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;neighbors&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;neighbors_map&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="c1"&gt;# loop over the colors&lt;/span&gt;
        &lt;span class="n"&gt;random&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;shuffle&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# Check if that color has not been used by one of the neighbors&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;neighbor&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;neighbors&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;neighbor&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;neighbor&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="k"&gt;break&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="c1"&gt;# We found a color for the city that has not been used by a neighbor!&lt;/span&gt;
                &lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;city&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;city&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Could not find color for {city}&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;colormap&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;So the whole calculation for color assignment looks like:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;colors&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#e41a1c&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#377eb8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#4daf4a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#984ea3&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#ff7f00&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#ffff33&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;colormap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;greedy_coloring&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;generate_intersections&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;colors&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;And we can then create recreate the map using these color assignments:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Set up the map axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the city shapes &lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attributes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;
    &lt;span class="c1"&gt;# Skip regions with invalid names&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;

    &lt;span class="c1"&gt;# Draw the shapes with their assigned color&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_geometries&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
                      &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_cities_color_2.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="los-angeles-color-2" src="/articles/coding/images/socal_cities_color_2.png"&gt;
Much better!&lt;/p&gt;
&lt;h2&gt;Adding labels&lt;/h2&gt;
&lt;p&gt;This map is still not that useful if we want to know the names of any of the cities shown.
We can naively try to plot them at the center of each city:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Set up the map axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the city shapes&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attributes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;
    &lt;span class="c1"&gt;# Skip regions with invalid names&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;

    &lt;span class="c1"&gt;# Draw the shapes with their assigned color&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_geometries&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; 
                      &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
                      &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Get the x and y position of the labels&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;centroid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;
    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;centroid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;
    &lt;span class="c1"&gt;# Add the label text&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clip_on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="n"&gt;ha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;va&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_cities_color_labels.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="los-angeles-color-labels" src="/articles/coding/images/socal_cities_color_labels.png"&gt;&lt;/p&gt;
&lt;p&gt;This is okay, but in some of the densest areas, the labels are overlapping each other.
Furthermore, it would be nice for the labels for large, populous cities (like LA proper)
to have larger labels than tiny towns. We could scale the label sizes with the population
size, but then the label for Los Angeles  (population several million) would be about
four hundred times the size of the label for the City of Industry (population two-hundred).
Instead, we will scale the label size with the log of the population.&lt;/p&gt;
&lt;p&gt;First, we can create a dictionary holding the population of each city:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;

&lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;data/la_cities.geojson&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;city_data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;population&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;city_data&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;features&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;properties&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="c1"&gt;# Some populations contain commas, so strip those&lt;/span&gt;
    &lt;span class="n"&gt;pop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;properties&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;population&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;
    &lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pop&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;Now, we can recreate the labeled map using the appropriately-scaled labels:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Set up the axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;

&lt;span class="c1"&gt;# Draw the city shapes&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attributes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;

    &lt;span class="c1"&gt;# Skip regions with invalid names&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_geometries&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; 
                      &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
                      &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Get the x and y position of the labels&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;centroid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;
    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;centroid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;
    &lt;span class="c1"&gt;# If the population is in the population map (as it is for most cities),&lt;/span&gt;
    &lt;span class="c1"&gt;# assign the font size to the log of the population&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; 
        &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clip_on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="n"&gt;ha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;va&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_cities_color_labels_2.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="los-angeles-color-labels2" src="/articles/coding/images/socal_cities_color_labels_2.png"&gt;&lt;/p&gt;
&lt;h1&gt;Putting it all together&lt;/h1&gt;
&lt;p&gt;We are now ready to make the final map. We will plot the following, in order:
1. SRTM hillshade data
1. City polygons
1. Water mask
1. City labels&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# Set up the map axes&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;axes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;projection&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_extent&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;119.31&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;116.9998611&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;33.32&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mf"&gt;34.74&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# Full LA metro area&lt;/span&gt;

&lt;span class="c1"&gt;# Plot the hillshade&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;intensity&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;gist_gray&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
          &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# Draw the city shapes&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;records&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attributes&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;geometry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;record&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;

    &lt;span class="c1"&gt;# Skip regions with invalid names&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;continue&lt;/span&gt;

    &lt;span class="c1"&gt;# Draw the shapes with their assigned color&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_geometries&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; 
                      &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;colormap&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; 
                      &lt;span class="n"&gt;edgecolor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;k&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lw&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# Get the x and y position of the labels&lt;/span&gt;
    &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;centroid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;
    &lt;span class="n"&gt;y&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;geometry&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;centroid&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;
    &lt;span class="c1"&gt;# If the population is in the population map (as it is for most cities),&lt;/span&gt;
    &lt;span class="c1"&gt;# assign the font size to the log of the population&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;population&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; 
        &lt;span class="n"&gt;size&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;np&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log10&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;3.&lt;/span&gt;
    &lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fontsize&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;clip_on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;True&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="n"&gt;ha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;va&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;center&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;transform&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ccrs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PlateCarree&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="c1"&gt;#Make a pure blue colormap, and plot the water mask&lt;/span&gt;
&lt;span class="n"&gt;cm&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;LinearSegmentedColormap&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;from_list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;water&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
     &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="mi"&gt;169&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;204&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;227&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;),(&lt;/span&gt;&lt;span class="mi"&gt;169&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;204&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;227&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;255&lt;/span&gt;&lt;span class="p"&gt;)])&lt;/span&gt;
&lt;span class="n"&gt;ax&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;imshow&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;water&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmap&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cm&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;origin&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;upper&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;alpha&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;extent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;srtm_extent&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;zorder&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;plt&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;savefig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;images/socal_total.png&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bbox_inches&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tight&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dpi&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;


&lt;p&gt;&lt;img alt="los-angeles-total" src="/articles/coding/images/socal_total.png"&gt;
And we are basically done!&lt;/p&gt;
&lt;h1&gt;Conclusions&lt;/h1&gt;
&lt;p&gt;There are a bunch of more detailed tweaks that can make this map better than
what I have shown here. There are duplicate entries to remove, labels to move around,
and colors to shift. The maps shown at the top of this post have those tweaks incorporated.&lt;/p&gt;
&lt;p&gt;I'll close with a few scattered thoughts about the process of making this map:&lt;/p&gt;
&lt;p&gt;First, the data provided by OpenStreetMap is pretty great. It is free, downloadable,
and has a &lt;em&gt;huge&lt;/em&gt; amount of information. The downside is that the databases you download
from OSM are poorly documented, and the data often needs to be substantially cleaned up.
There are a lot of duplicate, contradictory, or nonsense entries. Some things are misclassified.&lt;/p&gt;
&lt;p&gt;Second, the quantity and quality of data downloadable from USGS or NASA is awesome.
However, as above, the web interfaces for locating and downloading it are confusing
and poorly documented.&lt;/p&gt;
&lt;p&gt;Finally, GDAL is indispensable for any kind of GIS processing. It understands just about
any format you can throw at it, and is &lt;em&gt;really&lt;/em&gt; fast. Unfortunately, it also has
confusing and incomplete documentation (are you sensing a theme here?).&lt;/p&gt;
&lt;p&gt;Feel free to let me know if you find this useful!&lt;/p&gt;</content></entry><entry><title>Ultriviolet catastrophe and the beginning of quantum mechanics</title><link href="/ultriviolet-catastrophe-and-the-beginning-of-quantum-mechanics.html" rel="alternate"></link><published>2016-06-06T00:00:00-07:00</published><updated>2016-06-06T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2016-06-06:/ultriviolet-catastrophe-and-the-beginning-of-quantum-mechanics.html</id><summary type="html">&lt;p&gt;&lt;img alt="sun" src="/articles/dimensional_analysis/images/sun.jpg"&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;We just finished a very long explication of the fundamentals of dimensional
analysis and the Buckingham Pi theorem 
(well, not "just", since it took me significantly longer 
than I anticipated to finish up this post).
That could be the end of this series, but it would be a shame to end it without showing at least one
example of some of the cool analysis that can be done in a more complicated
system than the ones we have considered so far.&lt;/p&gt;
&lt;p&gt;The example that we will be considering is the problem of the "ultraviolet
catastrophe", a famous problem which demonstrated in the late nineteenth
and early twentieth century that not all was well with classical physics.
It also has the distinction of having one of the coolest names for an 
unsolved problem in science. For a long time sedimentary geology had 
an unsolved problem about the origin of the mineral dolomite, known as
the "dolomite problem". Doesn't quite have the same ring to it.&lt;/p&gt;
&lt;h2&gt;Spectral radiance&lt;/h2&gt;
&lt;p&gt;At its heart, the ultraviolet catastrophe has to do with the question of how
hot objects cool off (as somebody who studies convection and the thermal
evolution of planets, I am biased towards thinking that a great many problems in 
science boil down to a question of how hot things cool off).
Nineteenth century scientists observed that objects at high temperatures
would radiate electromagnetic waves to space around them in a process known as radiative cooling.
We are all quite familiar with the effects of radiative cooling, even if we
do not recognize it: the sun is an immensely hot ball of matter, and that heat is
radiated to space as electromagnetic waves, which we percieve as as the
warmth and brightness of a sunny day.&lt;/p&gt;
&lt;p&gt;Scientists further observed that hot bodies such as the sun did 
not radiate light at a single frequency but rather as a spectrum:&lt;/p&gt;
&lt;p&gt;&lt;img alt="solar spectrum" src="/articles/dimensional_analysis/images/solar_spectrum.svg" title="Wavelength (rather than frequency) vs radiance of the sun. (image from Global Warming Art)"&gt;&lt;/p&gt;
&lt;p&gt;Furthermore, the shape of that spectrum and its peak
frequency seemed to be a function of the body's temperature. 
At lower temperatures, the object would give off predominantly 
lower frequency radiation and at higher temperatures it would give off
predominantly higher frequency radiation.&lt;/p&gt;
&lt;p&gt;Most objects that we interact with on a daily basis are at too low of 
temperatures to radiate in the visible spectrum, but you have probably
seen a hot poker glow red, which means it is certainly too hot to touch.
If it gets a lot hotter than that, it may start to glow white, reflecting
the presence of higher frequency radiation.&lt;/p&gt;
&lt;p&gt;The question of the radiative spectrum that a body emits is not just of 
theoretical interest: it is intensely practical in many areas of science
and engineering. After all, if we could understand what determines the 
spectrum of a radiating body, we can measure its temperature without
needing to touch it, nor do we even need to be particularly close to it.
We just need to be able to see it. This would allow us to know the temperature
of stars and planets, as well as measure the temperature of many otherwise
difficult to access laboratory experiments.&lt;/p&gt;
&lt;p&gt;Indeed, let's frame the question of spectral radiance in terms of our
initial example: the sun. We would like to be able to look at the spectrum
of the light given off by the sun and answer two fundamental questions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;How hot is the sun?&lt;/li&gt;
&lt;li&gt;How much energy does the sun radiate to space?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="sun" src="/articles/dimensional_analysis/images/sun.jpg" title="WHAT IS MY TEMPERATURE (NASA/JPL)"&gt;&lt;/p&gt;
&lt;p&gt;Okay, so with that prelude, let's take a crack at the dimensional analysis of this problem.
The observation that we are trying to explain is the radiation of 
energy from the surface of an object. That is to say, for a given frequency the object
gives off a certain amount of energy per unit surface area per unit time, or
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
[B] = \frac{\text{energy}}{\text{frequency} \cdot \text{area} \cdot \text{time} }
\end{equation}&lt;/div&gt;
&lt;p&gt;
This quantity &lt;span class="math"&gt;\(B\)&lt;/span&gt; is known as the spectral radiance.
Expressed in terms of SI units it becomes
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
[B] = \frac{\mathrm{kg}}{\mathrm{s}^2}
\label{units_spectral_radiance}
\end{equation}&lt;/div&gt;
&lt;p&gt;
The picky may note that the conventional dimensions of this quantity also
include the units of the solid angle over which this energy is measured.
This solid angle is dimensionless (steradians), so does not affect the 
analysis here. If you like, you can pretend I have integrated over some
solid angle and am carrying around an additional parameter indicating that
angle. It is otherwise unimportant here.&lt;/p&gt;
&lt;h2&gt;Dimensional accounting&lt;/h2&gt;
&lt;p&gt;We now need to list the parameters that are important for this problem.
We already know several based upon the observations. First, we know that the frequency
of the radiation &lt;span class="math"&gt;\(\nu\)&lt;/span&gt; plays a role. Second, we know that the temperature &lt;span class="math"&gt;\(T\)&lt;/span&gt;
of the body in question must matter, since the temperature dependence of the spectrum
is one of our fundamental observations. And if temperature is important, Boltzmann's
constant &lt;span class="math"&gt;\(k_B\)&lt;/span&gt; cannot be far behind, since that is statistical mechanics'
bridge between temperature and energy. Finally, we are talking about heat
transfer by the propagation of electromagnetic waves through space before
they reach our instruments (or eyes). Therefore the speed of light &lt;span class="math"&gt;\(c\)&lt;/span&gt; is
probably important to this problem. &lt;/p&gt;
&lt;p&gt;You may be tempted to include the wavelength of the light as an additional parameter.
However, the wavelength is related to the frequency and the speed of light through
the equation &lt;span class="math"&gt;\(\lambda = c/\nu\)&lt;/span&gt;, and as such should not be regarded as an independent parameter.&lt;/p&gt;
&lt;p&gt;The above parameters have units&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{aligned}
\left[ \nu \right] &amp;amp;= \frac{1}{\mathrm{s}} \\
[T] &amp;amp;= \mathrm{K} \\
[k_B] &amp;amp;= \frac{\mathrm{kg} \; \mathrm{m}^2}{\mathrm{s}^2 \; \mathrm{K}} \\
[c] &amp;amp;= \frac{\mathrm{m}}{\mathrm{s}}
\end{aligned}
\label{parameters}
\end{equation}&lt;/div&gt;
&lt;p&gt;Is that enough? Well, let's apply the Buckingham Pi theorem: the number
of fundamental units &lt;span class="math"&gt;\(k\)&lt;/span&gt; is four: &lt;span class="math"&gt;\(\mathrm{kg}\)&lt;/span&gt;, &lt;span class="math"&gt;\(\mathrm{K}\)&lt;/span&gt;, &lt;span class="math"&gt;\(\mathrm{m}\)&lt;/span&gt;, and &lt;span class="math"&gt;\(\mathrm{s}\)&lt;/span&gt;.
The number of parameters &lt;span class="math"&gt;\(n\)&lt;/span&gt; is also four. Therefore, the number of nondimensional
numbers &lt;span class="math"&gt;\(n-k\)&lt;/span&gt; in this problem is zero, meaning there is only one way to combine
the parameters in a way to get the units of equation \eqref{units_spectral_radiance}.&lt;/p&gt;
&lt;p&gt;The ambitious reader can try themselves, either by hand or by using the 
&lt;a href="https://github.com/ian-r-rose/buckinghampy"&gt;buckinghampy software&lt;/a&gt;
&lt;a href="automated-dimensional-analysis.html"&gt;developed previously&lt;/a&gt;.
Otherwise, here is the one way to get the dimensions of spectral radiance:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
B \sim \frac{k_B T \nu^2}{c^2}
\label{rayleigh-jeans}
\end{equation}&lt;/div&gt;
&lt;p&gt;Up to a factor of two, this equation is known as the 
&lt;a href="https://en.wikipedia.org/wiki/Rayleigh%E2%80%93Jeans_law"&gt;Rayleigh-Jeans&lt;/a&gt; law. 
It was developed to explain the spectrum of radiating bodies, and, at least for
lower temperatures, it did a pretty good job. All we need to do is fit our observed
spectrum to the Rayleigh-Jeans law to determine the temperatures.
So we could pat ourselves on the back. Another dimensional analysis job well done.&lt;/p&gt;
&lt;h2&gt;The Ultraviolet Catastrophe&lt;/h2&gt;
&lt;p&gt;When we try to use the Rayleigh-Jeans law to fit a spectrum that looks
like that of the sun (shown above), we might start to get a little nervous.
After all, the Rayleigh-Jeans law is quadratic in the frequency, which
should make a parabola on a frequency-radiance plot. The solar spectrum
certainly does not look like a parabola.&lt;/p&gt;
&lt;p&gt;Things start to really go sideways when we try to answer our second question
about the sun: how much energy is it radiating to space?
After all, we are not only interested in its temperature, but also its
ability to heat other planets, and its thermal evolution over the history of the solar system.
Well, we have an expression that gives the energy radiated as a function of frequency. 
As far as we know, no frequencies of light are special: all are equally possible.
We can go to arbitrarily high frequencies by inserting more wiggles
(for more on this, read about the &lt;a href="https://en.wikipedia.org/wiki/Equipartition_theorem"&gt;equipartition theorem&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;So we should be able to get the total energy per unit area per time radiating from the 
body by integrating over all the possible frequencies. That is to say,
we need to integrate equation \eqref{rayleigh-jeans} with respect to frequency from zero to infinity:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
E \sim \int_0^\infty \frac{k_B T \nu^2}{c^2} d\nu
\label{integrated_rayleigh_jeans}
\end{equation}&lt;/div&gt;
&lt;p&gt;Here is a plot of that integral:&lt;/p&gt;
&lt;p&gt;&lt;img alt="ultraviolet" src="/articles/dimensional_analysis/images/ultraviolet_catastrophe.png" title="A catastrophe indeed"&gt;&lt;/p&gt;
&lt;p&gt;Uh oh. There is a problem. There is no way that this integral can possibly converge
on a finite answer, since the &lt;span class="math"&gt;\(\nu^2\)&lt;/span&gt; factor must blow up as we integrate to infinity.
We are therefore led to the conclusion that a body which is radiating to space
has to radiate an infinite amount of energy per unit time. This cannot possibly be true,
otherwise we would have been building power plants around all manner of trash to
harness some of that power. This result, which was due to a fundamental flaw in 
classical physics, is the famous "ultraviolet catastrophe." It is so named due
to the catastrophic blowing up of the radiated energy at the higher, ultraviolet frequencies.&lt;/p&gt;
&lt;h2&gt;Quantization&lt;/h2&gt;
&lt;p&gt;From a dimensional standpoint, the ultraviolet catastrophe is pretty inevitable.
There is no way to prevent equation \eqref{integrated_rayleigh_jeans} from 
blowing up at high frequencies since this is the only form of the equation
for spectral radiance allowable. The only way out is to introduce some
extra physics, which will, in turn, enrich the parameter space and provide us an out.&lt;/p&gt;
&lt;p&gt;Enter &lt;a href="https://en.wikipedia.org/wiki/Max_Planck"&gt;Max Planck&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="planck" src="/articles/dimensional_analysis/images/planck.gif" title="Hey there, good looking"&gt;&lt;/p&gt;
&lt;p&gt;Planck was a German physicist working on on this problem around the turn of the twentieth century. 
In an effort to better match the observations, 
he made the assumption that the radiated energy could only be emitted in discrete
packets of energy (called "quanta," whence the term "quantum mechanics").
These quanta were related to the frequency of the radiation via a constant &lt;span class="math"&gt;\(h\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
E_{\mathrm{quanta}} = h \nu
\end{equation}&lt;/div&gt;
&lt;p&gt;The ramifications of this assumption were enormous
(many of which made Planck, and later Einstein, uncomfortable). 
These consequences, however, are well outside of the scope of this article.
For our purposes, this new parameter &lt;span class="math"&gt;\(h\)&lt;/span&gt; will have some pretty significant consequences
for our dimensional analysis.&lt;/p&gt;
&lt;h2&gt;A new dimensional accounting&lt;/h2&gt;
&lt;p&gt;Max Planck's new constant, which now bears his name, has the units&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
[h] = \frac{ \mathrm{kg} \; \mathrm{m}^2 }{\mathrm{s}}
\end{equation}&lt;/div&gt;
&lt;p&gt;If you have been following this series so far, the significance of having a new parameter
should be clear: we have now increased the dimension of the nullspace, allowing for one
(and only one) nondimensional number to enter the problem.&lt;/p&gt;
&lt;p&gt;A bit of rearranging the parameters is enough to figure out what that number must be
(I encourage the reader to work it out for themselves):&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\xi = \frac{h \nu}{k_B T}
\label{nondim}
\end{equation}&lt;/div&gt;
&lt;p&gt;We now have a new degree of freedom when it comes to representing the units
of the spectral radiance, allowing us to write down its general form:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
B \sim \frac{h \nu^3}{c^2} f(\xi)
\end{equation}&lt;/div&gt;
&lt;p&gt;Notice that if &lt;span class="math"&gt;\(f(\xi) = 1/\xi\)&lt;/span&gt; then we can recover the Rayleigh-Jeans law.
However, dimensionally speaking, &lt;span class="math"&gt;\(f(\xi)\)&lt;/span&gt; can be anything.
As before, we can ask the question of what the total energy radiating
from the sun is. The analogue to equation \eqref{integrated_rayleigh_jeans} is&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
E \sim \int_0^\infty \frac{h \nu^3}{c^2} f(\xi) d\nu
\label{almost_stefan_boltzmann}
\end{equation}&lt;/div&gt;
&lt;p&gt;Unlike equation \eqref{integrated_rayleigh_jeans}, this actually
has a chance of converging. As long as &lt;span class="math"&gt;\(f(\xi)\)&lt;/span&gt; goes to zero
fast enough as &lt;span class="math"&gt;\(\nu^3\)&lt;/span&gt; goes to infinity, the total amount of energy
will remain bounded. Do we have any guarantees that &lt;span class="math"&gt;\(f(\xi)\)&lt;/span&gt; will do that?
Unfortunately not. This is just about as far as dimensional analysis can take us.&lt;/p&gt;
&lt;p&gt;To go further, we would need to bring in some physics, which Max Planck has
helpfully done by working out the functional form of &lt;span class="math"&gt;\(f(\xi)\)&lt;/span&gt;:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
f(\xi) = \frac{1}{e^{\xi} - 1}
\end{equation}&lt;/div&gt;
&lt;p&gt;This does indeed converge when you perform the integration in equation \eqref{almost_stefan_boltzmann}
(though I do not evaluate the integral here).&lt;/p&gt;
&lt;p&gt;Here is the plot of what is now known as Planck's law, relating frequency to spectral radiance.
As you can see, the shape of the curve looks much more like that of the observed solar spectrum
and the area underneath the curve does not blow up:&lt;/p&gt;
&lt;p&gt;&lt;img alt="planck_law" src="/articles/dimensional_analysis/images/planck_law.png" title="Catastrophe averted"&gt;&lt;/p&gt;
&lt;p&gt;We can now safely fit the solar spectrum to Planck's law to determine the temperature
of the sun, all without actually going there. And though we used the sun as our primary
example, this works for basically anything: using Planck's law we know to pretty high
accuracy the temperature of most visible astronomical objects.&lt;/p&gt;
&lt;h2&gt;The Stefan-Boltzmann law&lt;/h2&gt;
&lt;p&gt;Okay, it wasn't strictly true that this was as far as dimensional analysis can take us.
There is one more trick we can do to interrogate the integral in equation \eqref{almost_stefan_boltzmann}.
A variable substitution will allow us to perform the integral over &lt;span class="math"&gt;\(\xi\)&lt;/span&gt; instead of &lt;span class="math"&gt;\(\nu\)&lt;/span&gt;.
Rearranging equation \eqref{nondim} gives us
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\nu = \frac{\xi k_B T}{h}
\end{equation}&lt;/div&gt;
&lt;p&gt;
and
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
d\nu = \frac{k_B T}{h} d\xi
\end{equation}&lt;/div&gt;
&lt;p&gt;Substituting these into equation \eqref{almost_stefan_boltzmann} gives us&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
E \sim \int_0^\infty \frac{\xi^3 k_B^4 T^4}{h^3 c^2} f(\xi) d\xi
\end{equation}&lt;/div&gt;
&lt;p&gt;The parameters &lt;span class="math"&gt;\(k_B\)&lt;/span&gt;, &lt;span class="math"&gt;\(T\)&lt;/span&gt;, &lt;span class="math"&gt;\(h\)&lt;/span&gt;, and &lt;span class="math"&gt;\(c\)&lt;/span&gt; do not depend on the frequency,
so we can pull them outside of the integral:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
E \sim \frac{k_B^4 T^4}{h^3 c^2} \int_0^\infty \xi^3 f(\xi) d\xi
\end{equation}&lt;/div&gt;
&lt;p&gt;Something kind of remarkable has just happened with this substitution:
the integral is a now a definite integral over a nondimensional function.
In other words, as long as the integrand converges,
the integral is just a number, nothing more.
So let's give that number a name, even if we do not know its value:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\gamma = \int_0^\infty \xi^3 f(\xi) d\xi
\end{equation}&lt;/div&gt;
&lt;p&gt;The equation for the total energy then becomes&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
E \sim \frac{ \gamma k_B^4 T^4}{h^3 c^2}
\label{stefan_boltzmann}
\end{equation}&lt;/div&gt;
&lt;p&gt;This equation, up to a constant which we can easily fold into &lt;span class="math"&gt;\(\gamma\)&lt;/span&gt;,
has a name: the &lt;a href="https://en.wikipedia.org/wiki/Stefan%E2%80%93Boltzmann_law"&gt;Stefan-Boltzmann law&lt;/a&gt;.
It tells us how much energy a radiating body gives off per unit time per unit area,
as a function of temperature.
In particular, it tells us that the energy radiated by a body is a &lt;em&gt;very&lt;/em&gt; strong
function of temperature: &lt;span class="math"&gt;\(T\)&lt;/span&gt; is raised to the fourth power, which becomes huge at higher temperatures.&lt;/p&gt;
&lt;p&gt;The Stefan-Boltzmann law finds many applications (for instance, in planetary science, it plays
a central role in calculating the greenhouse effect of an atmosphere),
and we were able to deduce it on on dimensional grounds (with an assist from Max Planck).&lt;/p&gt;
&lt;h2&gt;Wrapping up&lt;/h2&gt;
&lt;p&gt;This is the end of my multi-part series of articles on dimensional analysis.
We &lt;a href="introduction-to-dimensional-analysis.html"&gt;began&lt;/a&gt; by describing the fundamental question that dimensional analysis asks.
We followed that up by giving a &lt;a href="nondimensional-numbers-and-the-buckingham-pi-theorem.html"&gt;qualitative explanation&lt;/a&gt;
of the theorem that answers that question: the Buckingham Pi theorem.
Then we gave an &lt;a href="linear-algebra-and-the-buckingham-pi-theorem.html"&gt;informal proof&lt;/a&gt; of the theorem. 
The proof wound up relying on some pretty standard results from linear algebra
(which computers are very good at doing), and so we 
&lt;a href="automated-dimensional-analysis.html"&gt;wrote&lt;/a&gt; a
&lt;a href="https://github.com/ian-r-rose/buckinghampy"&gt;small Python package&lt;/a&gt;
that applies the Buckingham Pi theorem to an arbitrary set of parameters.
Finally, in this article we investigated a problem of some historical importance
through the lens of dimensional analysis (and I think it worked reasonably well).&lt;/p&gt;
&lt;p&gt;A lot of the ideas in this series were drawn from the excellent treatises of
Percy Bridgman and G.I. Barenblatt on the topic of dimensional analysis, as
well as from the inimitable Wikipedia.
Any errors or omissions are my own.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Automated dimensional analysis</title><link href="/automated-dimensional-analysis.html" rel="alternate"></link><published>2015-10-28T00:00:00-07:00</published><updated>2015-10-28T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2015-10-28:/automated-dimensional-analysis.html</id><summary type="html">&lt;p&gt;&lt;img alt="couette" src="/articles/dimensional_analysis/images/couette.svg"&gt;&lt;/p&gt;</summary><content type="html">&lt;style type="text/css"&gt;/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell &gt; div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area &gt; div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area &gt; div.highlight &gt; pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the &lt;head&gt; if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev &lt;Maniac@SoftwareManiacs.Org&gt;
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell &gt; div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
&lt;/style&gt;
&lt;style type="text/css"&gt;.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */&lt;/style&gt;
&lt;style type="text/css"&gt;
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
&lt;/style&gt;
    &lt;style type="text/css"&gt;

    div.output_area .MathJax_Display {
      text-align: center !important;
    }

    div.output_area {
      justify-content: center;
    }
    &lt;/style&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;&lt;a href="linear-algebra-and-the-buckingham-pi-theorem.html"&gt;Last time&lt;/a&gt; we showed that the Buckingham Pi theorem follows directly from one of the central results of linear algebra:
the &lt;a href="https://en.wikipedia.org/wiki/Rank%E2%80%93nullity_theorem"&gt;rank-nullity theorem&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The normal approach to dimensional analysis involves a certain amount of playing with the parameters, reorganizing them, and looking for their nondimensional combinations.
The understanding from a linear algebra standpoint suggests the possibility of making a computer perform dimensional analysis for you.
After all, computers are very, very good at linear algebra, and an astounding amount of &lt;a href="http://www.netlib.org"&gt;effort&lt;/a&gt; has gone into making numerical linear algebra routines fast and robust.&lt;/p&gt;
&lt;p&gt;This is not to say that the usual approach is bad.
In fact, I suspect that it is still essential for getting a good intuitive feel for a set of equations.
That being said, approaching the problem from a different perspective has value, and the more ways we can understand something, the better of an understanding we have.&lt;/p&gt;
&lt;p&gt;It's been said that the best way to learn something is to teach it. I suspect a similar principle applies for programming.
Programming is really all about teaching a computer to do a task, and computers are about the worst students you can imagine.
After all, they are (arguably) incapable of drawing conclusions from limited data, making intuitive leaps, and developing ideas beyond their own limited knowledge.
If you can teach a computer to do something, you probably have a reasonably good understanding of that thing.&lt;/p&gt;
&lt;p&gt;On the other hand, computers rarely make arithmetic mistakes.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Buckinghampy"&gt;Buckinghampy&lt;a class="anchor-link" href="#Buckinghampy"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;Here we will be developing a small Python package for automating dimensional analysis. I have named it, in one of the worst (best?) pun applications, Buckinghampy. If you want to play with the code, you can download the package &lt;a href="https://github.com/ian-r-rose/buckinghampy"&gt;here&lt;/a&gt;, or download and run this IPython notebook &lt;a href="https://github.com/ian-r-rose/ian-r-rose.github.io/blob/source/content/notebooks/automated_dimensional_analysis.ipynb"&gt;here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The main tool we will use for automating dimensional analysis will be the Python symbolic algebra package &lt;a href="www.sympy.org"&gt;SymPy&lt;/a&gt;. 
It is also possible to do the same operations with the more commonly used numpy package (indeed, an early version of this article did use numpy). 
However, SymPy uses arbitrary precision arithmetic, while numpy uses floating point arithmetic, making it subject to roundoff errors.
We expect our nondimensional numbers to involve small integer powers of the parameters,
and having the answers as floating point numbers makes these integers more of a pain to identify.&lt;/p&gt;
&lt;p&gt;To begin, we import SymPy, and initialize its printing system to allow for some nice typesetting of SymPy types:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sympy&lt;/span&gt;
&lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init_printing&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The first step will be to describe what we mean be a parameter.
For this, we will be defining a lightweight class:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;symbol&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;symbol&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;where &lt;code&gt;symbol&lt;/code&gt; is a string that we will use for typesetting the final results and &lt;code&gt;units&lt;/code&gt; is a Python dictionary that defines a mapping between a fundamental unit and the power of that unit in the parameter. For instance, we can define a parameter for the acceleration due to gravity $g$, which has units $\mathrm{m}/\mathrm{s}^2$ by writing&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;gravity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;g&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;or we can define a parameter for density $\rho$, which has units $\mathrm{kg}/\mathrm{m}^3$&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;density&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;rho&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;In this instance the &lt;code&gt;symbol&lt;/code&gt; string is the $\LaTeX$ symbol for $\rho$.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;Okay, so we have a type defining the relevant information for a given parameter.
Now we need to be able to construct the dimension matrix described in the previous article. As a reminder, the dimension matrix is an $k$ by $n$ matrix, where $n$ is the number of parameters and $k$ is the number of fundamental units that appear in the parameters. The entries of the matrix are the exponent of the given unit in the given parameter.&lt;/p&gt;
&lt;p&gt;The following function &lt;code&gt;construct_dimension_matrix()&lt;/code&gt; takes a list of &lt;code&gt;Parameter&lt;/code&gt; objects. It constructs a sorted list of the fundamental units, allocates a Sympy matrix of the correct shape, and then fills the entries of the matrix:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;construct_dimension_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Storing the units in a set means that we ignore&lt;/span&gt;
    &lt;span class="c1"&gt;# duplicate units, and will just have a set of all&lt;/span&gt;
    &lt;span class="c1"&gt;# the units which appear at least once in the problem:&lt;/span&gt;
    &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# The downside of a set is that it is unordered. It is&lt;/span&gt;
    &lt;span class="c1"&gt;# nice to have the units be alphabetized for easier &lt;/span&gt;
    &lt;span class="c1"&gt;# inspection of the matrix, so we convert the units &lt;/span&gt;
    &lt;span class="c1"&gt;# set to a list, then alphabetize that.&lt;/span&gt;
    &lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="c1"&gt;#Construct a matrix of the appropriate shape&lt;/span&gt;
    &lt;span class="n"&gt;dimension_matrix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sympy&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;zeros&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
    
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# Determine the matrix entry for i,j&lt;/span&gt;
            &lt;span class="c1"&gt;# If the unit appears in the parameter,&lt;/span&gt;
            &lt;span class="c1"&gt;# then it is the power of that unit,&lt;/span&gt;
            &lt;span class="c1"&gt;# otherwise it is zero&lt;/span&gt;
            &lt;span class="n"&gt;entry&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;u&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
            &lt;span class="n"&gt;dimension_matrix&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;entry&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dimension_matrix&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;The function returns the list of fundamental units and the dimension matrix for the set of parameters.&lt;/p&gt;
&lt;p&gt;As an example, we can try the case of Couette flow from the previous articles. In case you have forgotten, Couette flow involves the motion of a fluid between two plates. The fluid has a density $\rho$ and a viscosity $\eta$. The two plates are separated by a distance $D$ and the top plate is shearing the fluid with a velocity $u_0$.&lt;/p&gt;
&lt;p&gt;&lt;img src="/articles/dimensional_analysis/images/couette.svg" alt="couette" title="I have reused this image enough that I no longer regret the time it took to make it"&gt;&lt;/p&gt;
&lt;p&gt;We can define these parameters and their units using the &lt;code&gt;Parameter&lt;/code&gt; type:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;viscosity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;eta&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kg&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;length&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;D&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;velocity&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;u_0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;density&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;rho&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;velocity&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;viscosity&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;With the parameters defined, we can give them as a list to the &lt;code&gt;construct_dimension_matrix&lt;/code&gt; function and output the resulting matrix:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dimension_matrix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
   &lt;span class="n"&gt;construct_dimension_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;dimension_matrix&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;

&lt;div class="output_area"&gt;



&lt;div class="output_latex output_subarea output_execute_result"&gt;
$$\left[\begin{matrix}1 &amp; 0 &amp; 0 &amp; 1\\-3 &amp; 1 &amp; 1 &amp; -1\\0 &amp; 0 &amp; -1 &amp; -1\end{matrix}\right]$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As you can verify, the columns correspond to the parameters in the order in which they were given. The rows correspond to the fundamental units in alphabetical order, so the first row is kilograms, the second row is meters, and the last row is seconds. So, reading down the third row, we can see that the velocity parameter $u_0$ has units of $\mathrm{m}/\mathrm{s}$.&lt;/p&gt;
&lt;p&gt;We learned previously that the nondimensional numbers which you can make out of the parameters provide, in a sense, a fundamental description of the problem. Furthermore, when we cast the problem in terms of the dimension matrix, the nondimensional numbers are precisely the set of vectors which span the nullspace of the matrix.&lt;/p&gt;
&lt;p&gt;Thus, since we have the dimension matrix, all we have to do now is find its nullspace. Fortunately, Sympy has a function which does exactly this (sensibly named &lt;code&gt;nullspace()&lt;/code&gt;), thus saving us a fair amount of effort:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nullspace&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dimension_matrix&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nullspace&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;nullspace&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;

&lt;div class="output_area"&gt;



&lt;div class="output_latex output_subarea output_execute_result"&gt;
$$\left [ \left[\begin{matrix}-1\\-1\\-1\\1\end{matrix}\right]\right ]$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;As we can see, the nullspace of this matrix is a single vector. This vector is a recipe for how to combine the parameters in such a way that the result has no dimensions. So the vector tells us that we have one power of $\eta$, and negative one power of each of $\rho$, $u_0$, and $D$, or&lt;/p&gt;
&lt;p&gt;\begin{equation}
\frac{\eta}{\rho u_0 D}
\end{equation}&lt;/p&gt;
&lt;p&gt;which you may recognize as the inverse of the Reynolds number!
Recall that the Reynolds number characterizes the ratio of inertial effects to viscous effects for a fluid.
Note that it makes no difference that this is the inverse of the traditionally defined Reynolds number: it is still a perfectly valid nondimensional number, and any power of it is also perfectly valid. The Reynolds number itself is just a convention for how to define the relevant nondimensional number.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;At this point, we have successfuly written some code that takes some parameters, assembles the dimension matrix and finds the nondimensional numbers associated with that problem. We could be done. It would be nice, however, not to have to read the parameters off of a vector of rational numbers, as we did above. Fortunately, it is not too difficult to write a new class, &lt;code&gt;NondimensionalNumber&lt;/code&gt;, which takes care of these details.&lt;/p&gt;
&lt;p&gt;The class is initialized with the list of parameters and a particular vector in the dimensional nullspace. It has an internal function &lt;code&gt;_parse_nondimensional_number()&lt;/code&gt; which takes that vector and parses it into a nice string which can be typeset via $\LaTeX$. If you are not comfortable with $\LaTeX$ typesetting, feel free to skip this block, it is mostly cosmetic:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NondimensionalNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nondimensional_vector&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;nondimensional_vector&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;string_representation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_parse_nondimensional_number&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_parse_nondimensional_number&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# Initialize two empty strings for the numerator and &lt;/span&gt;
        &lt;span class="c1"&gt;# denominator of the nondimensional number&lt;/span&gt;
        &lt;span class="n"&gt;numerator_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;denominator_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;zip&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;vector&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# No need to typeset the parameters if they do not &lt;/span&gt;
            &lt;span class="c1"&gt;# appear in the nondimensional number&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;continue&lt;/span&gt;
            &lt;span class="c1"&gt;# If the exponent on the parameter is one,&lt;/span&gt;
            &lt;span class="c1"&gt;# we do not need to write it.&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;parsed_parameter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt;
            &lt;span class="c1"&gt;# If the exponent is a whole number, we do&lt;/span&gt;
            &lt;span class="c1"&gt;# not need to represent it as a fraction.&lt;/span&gt;
            &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;parsed_parameter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
                        &lt;span class="s1"&gt;&amp;#39;^{&lt;/span&gt;&lt;span class="si"&gt;%i&lt;/span&gt;&lt;span class="s1"&gt;}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="c1"&gt;# Otherwise, represent it as a fraction&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;parsed_parameter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;symbol&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; \
                        &lt;span class="s1"&gt;&amp;#39;^{&lt;/span&gt;&lt;span class="si"&gt;%i&lt;/span&gt;&lt;span class="s1"&gt;/&lt;/span&gt;&lt;span class="si"&gt;%i&lt;/span&gt;&lt;span class="s1"&gt;}&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;abs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    
            &lt;span class="c1"&gt;# Depending upon whether the exponent is positive or &lt;/span&gt;
            &lt;span class="c1"&gt;# negative, put it in the numerator or the denominator&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;numerator_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;\
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;numerator_string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parsed_parameter&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
            &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;denominator_string&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39; &amp;#39;&lt;/span&gt;\
                    &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;denominator_string&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parsed_parameter&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
        
        &lt;span class="c1"&gt;# If the numerator is empty, make it a one&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;numerator_string&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;parsed_number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;frac{1}{&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;denominator_string&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;}&amp;#39;&lt;/span&gt;
        &lt;span class="c1"&gt;# If the denominator is empty, there is no need for a fraction&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="n"&gt;denominator_string&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;parsed_number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;numerator_string&lt;/span&gt;
        &lt;span class="c1"&gt;# Otherwise make it a fraction&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;parsed_number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;frac{&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;numerator_string&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;\
                            &lt;span class="s1"&gt;&amp;#39;}{&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;denominator_string&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;}&amp;#39;&lt;/span&gt;
                        
        &lt;span class="c1"&gt;# And we are done! We return a LaTeX string&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;parsed_number&lt;/span&gt;
    
    &lt;span class="c1"&gt;# Let IPython know how this may be typeset with LaTeX&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_repr_latex_&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;$$&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;string_representation&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;$$&amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;# Return the string form of the nondimensional number&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;string_representation&lt;/span&gt;

&lt;span class="c1"&gt;# This is a bit of a hack: Here I am subclassing&lt;/span&gt;
&lt;span class="c1"&gt;# the builtin Python list type and adding a&lt;/span&gt;
&lt;span class="c1"&gt;# function for print_latex(). This allows&lt;/span&gt;
&lt;span class="c1"&gt;# IPython to be able to render a list of &lt;/span&gt;
&lt;span class="c1"&gt;# nondimensional numbers as well as a single one.&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;NondimensionalNumberList&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# Make a comma delimited list of the &lt;/span&gt;
    &lt;span class="c1"&gt;# nondimensional numbers&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;string_representation&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__getitem__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="n"&gt;string_representation&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;n&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;string_representation&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;, &amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;string_representation&lt;/span&gt;
    
    &lt;span class="c1"&gt;#Add symbols for typesetting with LaTeX&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;print_latex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;$$&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;$$&amp;#39;&lt;/span&gt; 

&lt;span class="c1"&gt;# Register the print function with IPython&lt;/span&gt;
&lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_ipython&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;display_formatter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;formatters&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;text/latex&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;\
    &lt;span class="n"&gt;for_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;NondimensionalNumberList&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; \
             &lt;span class="n"&gt;NondimensionalNumberList&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;print_latex&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We can now use this function to typeset the Reynolds number:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;Re&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NondimensionalNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nullspace&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="n"&gt;Re&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;

&lt;div class="output_area"&gt;



&lt;div class="output_latex output_subarea output_execute_result"&gt;
$$\frac{ \eta}{ \rho D u_0}$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;To finish this coding exercise, we can tie it all up into a single function that takes a list of parameters and returns a list of nondimensional numbers. Remember, the overall steps to this process were&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Construct the dimension matrix&lt;/li&gt;
&lt;li&gt;Find the vectors spanning the nullspace of the dimension matrix&lt;/li&gt;
&lt;li&gt;Parse those vectors into human-readable nondimensional numbers&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;We have already done each of these steps individually, we just need to put them in one place, the function &lt;code&gt;find_nondimensional_numbers()&lt;/code&gt;:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;find_nondimensional_numbers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# First, create the dimension matrix&lt;/span&gt;
    &lt;span class="n"&gt;units&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dimension_matrix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; \
        &lt;span class="n"&gt;construct_dimension_matrix&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# Second, find the nullspace of the dimension matrix&lt;/span&gt;
    &lt;span class="n"&gt;nullspace&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dimension_matrix&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nullspace&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# Third, convert the vectors in the &lt;/span&gt;
    &lt;span class="c1"&gt;# nullspace to nondimensional numbers&lt;/span&gt;
    &lt;span class="n"&gt;nondimensional_numbers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NondimensionalNumberList&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;\
                &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;NondimensionalNumber&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; \
                 &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;nullspace&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="c1"&gt;# Finally, return the list of nondimensional numbers&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;nondimensional_numbers&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;And now we can find the Reynolds number by calling this function:&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;nondim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;find_nondimensional_numbers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;nondim&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;

&lt;div class="output_area"&gt;



&lt;div class="output_latex output_subarea output_execute_result"&gt;
$$\frac{ \eta}{ \rho D u_0}$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;That's more like it! We now have the problem of finding the nondimensional numbers associated with a particular problem down to a single function call!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="More-involved-examples"&gt;More involved examples&lt;a class="anchor-link" href="#More-involved-examples"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;The problem we have been working with is a relatively simple problem, with a single nondimensional number. More complicated problems can have many nondimensional numbers, each describing some aspect of the physics of the problem. That is to say, as we add more physics, we expect to have more nondimensional numbers at play. I'd like to close out this article with a coupld of examples of this.&lt;/p&gt;
&lt;p&gt;First, we can consider an elaboration on shearing flow: what if the fluid was a river? Like Couette flow, rivers exist in a channel, but they also move under the influence of gravity. The force of gravity determines the dynamics of ripples and waves along its surface and the speed at which the river moves downhill. It also is extremely important for characterizing the rate of &lt;a href="https://en.wikipedia.org/wiki/Saltation_%28geology%29"&gt;sediment transport&lt;/a&gt; downstream, which has important geomorphological, agricultural, and environmental consequences.&lt;/p&gt;
&lt;p&gt;&lt;img src="/articles/dimensional_analysis/images/oranje.jpg" alt="oranje" title="All right! An excuse for a picture!"&gt;&lt;/p&gt;
&lt;p&gt;Since gravity is a primary control on the river dynamics, we had better include that in our list of parameters. Regenerating the parameter list, and finding the nondimensional numbers, we get&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;density&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;velocity&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;viscosity&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;gravity&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;nondim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;find_nondimensional_numbers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;nondim&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;

&lt;div class="output_area"&gt;



&lt;div class="output_latex output_subarea output_execute_result"&gt;
$$\frac{ \eta}{ \rho D u_0}, \frac{ D g}{ u_0^{2}}$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We see that, as before, we get one over the Reynolds number $1/Re$. However, now there is a second nondimensional number, given by
\begin{equation}
\frac{D g}{u_0^2}
\end{equation}
This number is a direct consequence of our adding the effects of gravity to the problem. We can see this as the ratio of gravitational forces ($\sim \rho g$) to inertial effects ($\sim \rho u_0^2/D$). As with the Reynolds number, this quantity is important enough that it has a name: the &lt;a href="https://en.wikipedia.org/wiki/Froude_number"&gt;Froude number&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Actually, the Froude number is usually defined as 
\begin{equation}
\mathrm{Fr} = \frac{u_0^2}{\sqrt{g D} }
\end{equation}
so what we actually found was $1/\mathrm{Fr}^2$. But remember, this is just a convention, and any power of a nondimensional number is just as valid. As you might imagine, the ratio of inertia to gravity is the primary control on the shape of waves in moving water, and as such is extremely important in the hydrodynamic design of ships.&lt;/p&gt;
&lt;p&gt;&lt;img src="/articles/dimensional_analysis/images/shipwreck.jpg" alt="shipwreck" title="Too much Froude, too much Reynolds"&gt;&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We'll consider a final example from geodesy of the solid Earth.
When a magma chamber underneath a volcano gets a fresh infusion of magma, the chamber gets overpressured.
This overpressure deflects the overlying surface upwards, which can be detedcted via satellites using &lt;a href="https://en.wikipedia.org/wiki/Interferometric_synthetic_aperture_radar"&gt;INSAR&lt;/a&gt;.
The image below depicts the deflection of Earth's surface at a volcano in the Galapagos from a study by &lt;a href="http://dx.doi.org/10.1038/35039604"&gt;Amelung et. al.(2000)&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src="/articles/dimensional_analysis/images/mogi.jpg" alt="mogi" title="It's gonna blow..."&gt;&lt;/p&gt;
&lt;p&gt;We would like to understand how the Earth deforms due to the overpressure in the magma chamber.
Using a dollop of intuition, we suppose that the deflection of the surface depends on the radius of the magma chamber $R$, the depth of the magma chamber $D$, and the overpressure $\Delta P$. 
Furthermore, it must depend on the elastic properties of the rock (which control how the rock deforms due to some stress).
We can describe these elastic properties using the shear modulus $\mu$ and the dimensionless Poisson's ratio $\nu$.&lt;/p&gt;
&lt;p&gt;Using the package we have developed, we can define these five parameters and find the nondimensional numbers.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing code_cell rendered"&gt;
&lt;div class="input"&gt;

&lt;div class="inner_cell"&gt;
    &lt;div class="input_area"&gt;
&lt;div class=" highlight hl-ipython2"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;overpressure&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;Delta P&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kg&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;shear_modulus&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;mu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;kg&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;s&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;poisson_ratio&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\\&lt;/span&gt;&lt;span class="s1"&gt;nu&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{})&lt;/span&gt;
&lt;span class="n"&gt;depth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;D&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="n"&gt;radius&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Parameter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;R&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;m&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;

&lt;span class="n"&gt;parameters&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;poisson_ratio&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;overpressure&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shear_modulus&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;depth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;radius&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;nondim&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;find_nondimensional_numbers&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parameters&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;nondim&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;

&lt;div class="output_wrapper"&gt;
&lt;div class="output"&gt;

&lt;div class="output_area"&gt;



&lt;div class="output_latex output_subarea output_execute_result"&gt;
$$ \nu, \frac{ \mu}{ \Delta P}, \frac{ R}{ D}$$
&lt;/div&gt;

&lt;/div&gt;

&lt;/div&gt;
&lt;/div&gt;

&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;p&gt;We find that the relevant nondimensional numbers are Poisson's ratio (already dimensionless), the ratio of the shear modulus to the overpressure, and the ratio of the radius of the magma chamber to its depth.
Comparison with an analytical approximation to this system, the Mogi source, shows that these three nondimensional numbers are the important controls on the system.&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="cell border-box-sizing text_cell rendered"&gt;&lt;div class="inner_cell"&gt;
&lt;div class="text_cell_render border-box-sizing rendered_html"&gt;
&lt;h2 id="Conclusion"&gt;Conclusion&lt;a class="anchor-link" href="#Conclusion"&gt;&amp;#182;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;That was a bit of a longer article than I intended, but I hope it provided an interesting perspective on dimensional analysis. 
I welcome comments and improvements to &lt;a href="https://github.com/ian-r-rose/buckinghampy"&gt;Buckinghampy&lt;/a&gt;, which I intend to be a teaching tool for this topic.
In my next post, I hope to take a dive into the problem which proved to be the beginning of the end for classical physics: the &lt;a href="https://en.wikipedia.org/wiki/Ultraviolet_catastrophe"&gt;ultraviolet catastrophe&lt;/a&gt;.
As is my wont, I will be doing so from the perspective of dimensional analysis.
How far can you get with this perspective? It turns out, surprisingly far!&lt;/p&gt;

&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
 


&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;
</content></entry><entry><title>Linear algebra and the Buckingham Pi theorem</title><link href="/linear-algebra-and-the-buckingham-pi-theorem.html" rel="alternate"></link><published>2015-09-29T00:00:00-07:00</published><updated>2015-09-29T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2015-09-29:/linear-algebra-and-the-buckingham-pi-theorem.html</id><summary type="html">&lt;div class="math"&gt;\begin{equation*} p = n-k \end{equation*}&lt;/div&gt;
&lt;p&gt; &lt;img alt="lightbulb" src="/articles/dimensional_analysis/images/lightbulb.png"&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</summary><content type="html">&lt;p&gt;We previously spent &lt;a href="introduction-to-dimensional-analysis.html"&gt;two&lt;/a&gt;
&lt;a href="nondimensional-numbers-and-the-buckingham-pi-theorem.html"&gt;longish&lt;/a&gt;
posts on motivating, and then semi-quantitatively describing the Buckingham Pi theorem.
Here we will try to describe the theorem more precisely and more generally, and the tool
we use will be linear algebra. As is always the case with mathematics, a more
precise and general solution is going to be more abstract. But bear with me,
hopefully it will not be too bad.&lt;/p&gt;
&lt;p&gt;As we've seen, the general statement of the problem is that we have 
some quantity in which we are interested, and some set of parameters
which we think describe the physics of that quantity. 
We know that the parameters must combine in some way to 
make something of the correct units (if not, they cannot possibly
be the correct set of parameters for the problem!).&lt;/p&gt;
&lt;p&gt;We can describe this setup in terms of a set of "fundamental units,"
which we define to be units which cannot be made by combining other units.&lt;br&gt;
For instance, meters and seconds are both fundamental units,
but velocity is not, since it can be made by dividing meters by seconds.
The choice of fundamental units is not necessarily unique, but by 
convention we most commonly use the SI measures for length (m),
time (s), temperature (K), mass (kg), quantity (mol), current (A),
and luminosity (cd).&lt;/p&gt;
&lt;p&gt;&lt;img alt="lightbulb" src="/articles/dimensional_analysis/images/lightbulb.png" title="not entirely sure how luminosity got in there"&gt;&lt;/p&gt;
&lt;p&gt;So, let's say that the quantity of interest is called &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;, and that
there are &lt;span class="math"&gt;\(n\)&lt;/span&gt; parameters &lt;span class="math"&gt;\(\omega_i\)&lt;/span&gt;, where &lt;span class="math"&gt;\(i\)&lt;/span&gt; goes from one to &lt;span class="math"&gt;\(n\)&lt;/span&gt;.
We denote the units of something by enclosing it in square brackets,
so the symbolic representation of the problem is
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{bmatrix}
\Omega
\end{bmatrix}
=
\begin{bmatrix}
\omega_1^{\alpha_1}\omega_2^{\alpha_2}...\omega_n^{\alpha_n}
\end{bmatrix}
\label{parameters}
\end{equation}&lt;/div&gt;
&lt;p&gt;That is to say, we expect to be able to make the units of &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;
by combining the parameters &lt;span class="math"&gt;\(\omega_i\)&lt;/span&gt; in some way, where each parameter
is raised to some power &lt;span class="math"&gt;\(\alpha_i\)&lt;/span&gt;.
Furthermore, we have chosen some set of fundamental units which we 
call &lt;span class="math"&gt;\(f_j\)&lt;/span&gt;, where the index is for the &lt;span class="math"&gt;\(j\)&lt;/span&gt;th fundamental unit that appears
in the problem. We denote the number of fundemental units by &lt;span class="math"&gt;\(k\)&lt;/span&gt;. 
Another way of representing the units of &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt; is by using those fundamental units:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{bmatrix}
\Omega
\end{bmatrix}
=
f_1^{\beta_1}f_2^{\beta_2} \cdots f_m^{\beta_k}
\label{fundamental_units}
\end{equation}&lt;/div&gt;
&lt;p&gt;
where the &lt;span class="math"&gt;\(\beta_j\)&lt;/span&gt; are the powers of the fundamental units that
make up the units of &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;.
Since both \eqref{parameters} and \eqref{fundamental_units} are equal to 
the same thing, we can set them equal to each other:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{bmatrix}
\omega_1^{\alpha_1}\omega_2^{\alpha_2} \cdots \omega_n^{\alpha_n}
\end{bmatrix}
=
f_1^{\beta_1}f_2^{\beta_2} \cdots f_m^{\beta_k}
\label{intermediate}
\end{equation}&lt;/div&gt;
&lt;p&gt;
where the &lt;span class="math"&gt;\(\beta_j\)&lt;/span&gt; are the powers of the fundamental units that
make up the units of &lt;span class="math"&gt;\(\Omega\)&lt;/span&gt;.
This next step gets a little ugly: we also know that each 
of the parameters &lt;span class="math"&gt;\(\omega_i\)&lt;/span&gt; has some units, so we 
can also represent them using the &lt;span class="math"&gt;\(f_j\)&lt;/span&gt;:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{bmatrix}
\omega_i
\end{bmatrix}
=
f_1^{\gamma_{1i}}f_2^{\gamma_{2i}} \cdots f_k^{\gamma_{ki}}
\end{equation}&lt;/div&gt;
&lt;p&gt;
where the &lt;span class="math"&gt;\(\gamma_{ji}\)&lt;/span&gt; are the powers for the &lt;span class="math"&gt;\(j\)&lt;/span&gt;th fundamental unit
in the &lt;span class="math"&gt;\(i\)&lt;/span&gt;th parameter.
We can substitute this representation of the units of the &lt;span class="math"&gt;\(\omega_i\)&lt;/span&gt;
into \eqref{intermediate}:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{aligned}
&amp;amp; f_1^{\gamma_{11}\alpha_1}
f_2^{\gamma_{21}\alpha_1}\cdots
f_k^{\gamma_{k1}\alpha_1}  \times \\\\
&amp;amp; f_1^{\gamma_{12}\alpha_2}
f_2^{\gamma_{22}\alpha_2}\cdots
f_k^{\gamma_{k2}\alpha_2} \times \\\\
&amp;amp; \vdots \\\\
&amp;amp; f_1^{\gamma_{1n}\alpha_n}
f_2^{\gamma_{2n}\alpha_n}\cdots
f_k^{\gamma_{kn}\alpha_n} \\\\
=
&amp;amp; f_1^{\beta_1}f_2^{\beta_2}...f_k^{\beta_k}
\end{aligned}
\end{equation}&lt;/div&gt;
&lt;p&gt;Almost there. We can now collect together each &lt;span class="math"&gt;\(f_j\)&lt;/span&gt; so that they
only appear once on the left hand side, so by the rules of exponents
their powers are added:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{aligned}
&amp;amp; f_1^{\gamma_{11}\alpha_1 + \gamma_{12}\alpha_2 \cdots \gamma_{1n} \alpha_n } \times \\\\
&amp;amp; f_2^{\gamma_{21}\alpha_1 + \gamma_{22}\alpha_2 \cdots \gamma_{2n} \alpha_n } \times \\\\
&amp;amp; \vdots \\\\
&amp;amp; f_k^{\gamma_{k1}\alpha_1 + \gamma_{k2}\alpha_2 \cdots \gamma_{kn} \alpha_n } \\\\
&amp;amp;= f_1^{\beta_1}f_2^{\beta_2}...f_k^{\beta_k}
\end{aligned}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Here is the cool part: because we chose the &lt;span class="math"&gt;\(f_j\)&lt;/span&gt; to be a set of fundamental
units, there is no way to make them out of the other fundamental units.
Therefore, if the above equation is true, then the exponents for 
each of the &lt;span class="math"&gt;\(f_j\)&lt;/span&gt; on both sides of the equation have to be equal!
So this (terribly) ugly equation is really just a set of much simpler
equations where we set the exponents of each &lt;span class="math"&gt;\(f_j\)&lt;/span&gt; to be equal:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{aligned}
\gamma_{11}\alpha_1 + \gamma_{12}\alpha_2 \cdots \gamma_{1n} \alpha_n &amp;amp;= \beta_1 \\\\
\gamma_{21}\alpha_1 + \gamma_{22}\alpha_2 \cdots \gamma_{2n} \alpha_n &amp;amp;= \beta_2 \\\\
\vdots \\\\
\gamma_{k1}\alpha_1 + \gamma_{k2}\alpha_2 \cdots \gamma_{kn} \alpha_n &amp;amp;= \beta_k\\\\
\end{aligned}
\end{equation}&lt;/div&gt;
&lt;p&gt;If you have ever learned linear algebra, this should start to look very familiar:
it is actually a matrix equation:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\begin{bmatrix}
\gamma_{11} &amp;amp; \gamma_{12} &amp;amp; \cdots &amp;amp; \gamma_{1n} \\\\
\gamma_{21} &amp;amp; \gamma_{22} &amp;amp; \cdots &amp;amp; \gamma_{2n} \\\\
\vdots &amp;amp; \ddots &amp;amp; &amp;amp; \vdots \\\\
\gamma_{k1} &amp;amp; \gamma_{k2} &amp;amp; \cdots &amp;amp; \gamma_{kn} \\\\
\end{bmatrix}
\begin{bmatrix}
\alpha_1 \\\\
\alpha_2 \\\\
\vdots \\\\
\alpha_n \\\\
\end{bmatrix}
=
\begin{bmatrix}
\beta_1 \\\\
\beta_2 \\\\
\vdots \\\\
\beta_k \\\\
\end{bmatrix}
\label{dimension_matrix}
\end{equation}&lt;/div&gt;
&lt;p&gt;Any time you can make your math problem look like a matrix equation,
you should be very happy. This is primarily for two reasons:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Linear algebra and matrix equations are an extremely well-developed
and well-understood branch of mathematics, with a rich set of tools
and very elegant theory. If your problem is a linear algebra problem
you can use all that.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Computers are quite good at doing linear algebra. The only thing
better than doing linear algebra is having a computer do it for you
&lt;a href="linear-algebra-and-the-buckingham-pi-theorem.html"&gt;[citation needed]&lt;/a&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Equation \eqref{dimension_matrix} is fairly abstract, but it represents
the same basic idea that we dealt with in the previous post: we 
need to combine the parameters (in a recipe defined by the &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt;'s)
in such a way to get the right dimensions (defined by the &lt;span class="math"&gt;\(\beta\)&lt;/span&gt;'s).
The matrix &lt;span class="math"&gt;\(\gamma_{ji}\)&lt;/span&gt; tells us how to convert between the parameters
and the dimensions.&lt;/p&gt;
&lt;p&gt;We can rewrite Equation \eqref{dimension_matrix} in a more compact notation:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\bar{\bar{\gamma}} \bar{\alpha} = \bar{\beta}
\label{dimension_equation}
\end{equation}&lt;/div&gt;
&lt;p&gt;
where one overbar indicates a vector, and two overbars indicate a matrix.&lt;/p&gt;
&lt;p&gt;A particular solution to \eqref{dimension_equation} tells us one way to 
combine the parameters to get the right units.
However, we saw previously that in some cases there was more than one
way to combine the parameters to get the right units, and this 
led to parameter combinations without any dimensions: so-called nondimensional numbers.
We could multiply by any function of these nondimensional numbers
and still get the units we wanted. We can represent this phenomenon using
our dimensional equation: suppose that we have a particular
combination of the &lt;span class="math"&gt;\(\alpha\)&lt;/span&gt;'s that satisfies Equation \eqref{dimension_equation},
which we denote by &lt;span class="math"&gt;\(\bar{\alpha}_0\)&lt;/span&gt;. Suppose furthermore that we have some
nondimensional number, denoted by &lt;span class="math"&gt;\(\bar{\pi}\)&lt;/span&gt;. Since&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\bar{\bar{\gamma}} \bar{\alpha}_0 = \bar{\beta}
\end{equation}&lt;/div&gt;
&lt;p&gt;we must also have&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\bar{\bar{\gamma}} \left( \bar{\alpha}_0 + \bar{\pi} \right) = \bar{\beta}
\end{equation}&lt;/div&gt;
&lt;p&gt;This is just a statement that the nondimensional number
&lt;span class="math"&gt;\(\bar{\pi}\)&lt;/span&gt; does not change the units of the answer.
We can subtract the above two equations to get&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\bar{\bar{\gamma}} \bar{\pi} = 0
\label{nullspace}
\end{equation}&lt;/div&gt;
&lt;p&gt;This is a very special equation in linear algebra, the solution to which is the 
&lt;em&gt;&lt;a href="https://en.wikipedia.org/wiki/Kernel_(linear_algebra)"&gt;nullspace&lt;/a&gt;&lt;/em&gt; of the matrix &lt;span class="math"&gt;\(\bar{\bar{\gamma}}\)&lt;/span&gt;.
The nullspace is the set of vectors which, when acted upon by a matrix, give the zero vector.
From a dimensional standpoint, equation \eqref{nullspace} is just saying that the 
nondimensional number vectors &lt;span class="math"&gt;\(\bar{\pi}\)&lt;/span&gt; indeed have no dimensions.
However, now we know that the nullspace of the matrix &lt;span class="math"&gt;\(\bar{\bar{\gamma}}\)&lt;/span&gt; is &lt;em&gt;exactly&lt;/em&gt;
the same thing as the set of nondimensional numbers for that problem.&lt;/p&gt;
&lt;p&gt;So why is the matrix representation of dimensional analysis useful?
The answer is that it allows us to apply one of the most important results of linear algebra: the 
&lt;a href="https://en.wikipedia.org/wiki/Rank%E2%80%93nullity_theorem"&gt;rank-nullity theorem&lt;/a&gt;.
The matrix &lt;span class="math"&gt;\(\bar{\bar{\gamma}}\)&lt;/span&gt; is, in general, not square: it has shape &lt;span class="math"&gt;\(k\)&lt;/span&gt; rows 
(the number of fundamental units) by &lt;span class="math"&gt;\(n\)&lt;/span&gt; columns (the number of parameters).
The rank-nullity theorem is a statement about the relationship between 
the dimensionality of the &lt;a href="https://en.wikipedia.org/wiki/Row_and_column_spaces"&gt;image&lt;/a&gt;
of a matrix (i.e. its rank), the dimensionality of the nullspace of 
that matrix, and the number of columns of that matrix.
The theorem states:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\mathrm{dim}(\mathrm{image}( \bar{\bar{\gamma}} ) ) + 
\mathrm{dim}(\mathrm{nullspace}(\bar{\bar{\gamma}}) ) = \mathrm{number \; of \; columns}
\label{rank-nullity}
\end{equation}&lt;/div&gt;
&lt;p&gt;If the rows of the matrix are linearly independent (which is not always the case!)
then the rank is just the number of rows &lt;span class="math"&gt;\(k\)&lt;/span&gt;.
The dimensionality of the nullspace of &lt;span class="math"&gt;\(\bar{\bar{\gamma}}\)&lt;/span&gt; is the number of 
nondimensional numbers in our problem &lt;span class="math"&gt;\(p\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;For our central problem of dimensional analysis, the number of rows is
the number of fundamental units &lt;span class="math"&gt;\(k\)&lt;/span&gt;, and the number of columns
is the number of parameters &lt;span class="math"&gt;\(n\)&lt;/span&gt;.
Then, by the rank-nullity theorem, the number of nondimensional numbers is just
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
p = n - k
\end{equation}&lt;/div&gt;
&lt;p&gt;which is exactly the statement of the Buckingham pi theorem! 
So we see, when reformulated in terms of linear algebra,
the Buckingham pi theorem is just an application of the rank-nullity theorem.
Not only is this an interesting mathematical result by itself,
it allows for a more careful treatment of dimensional analysis problems
in more complicated cases where the actual list of parameters is
unclear, or when they may be linearly dependent on each other.&lt;/p&gt;
&lt;p&gt;To be more concrete, we can return to the example of 
&lt;a href="https://en.wikipedia.org/wiki/Couette_flow"&gt;Couette flow&lt;/a&gt;.
The parameters are the viscosity &lt;span class="math"&gt;\(\eta \; (\mathrm{kg}/\mathrm{m s})\)&lt;/span&gt;, 
the density &lt;span class="math"&gt;\(\rho \; (\mathrm{kg}/\mathrm{m}^3)\)&lt;/span&gt;,
the separation distance &lt;span class="math"&gt;\(D \; (\mathrm{m})\)&lt;/span&gt;, 
and the upper plate velocity &lt;span class="math"&gt;\(u_0 \; (\mathrm{m/s})\)&lt;/span&gt;.
The fundamental units are mass (&lt;span class="math"&gt;\(kg\)&lt;/span&gt;), length (&lt;span class="math"&gt;\(m\)&lt;/span&gt;), and time (&lt;span class="math"&gt;\(s\)&lt;/span&gt;).&lt;/p&gt;
&lt;p&gt;&lt;img alt="couette" src="/articles/dimensional_analysis/images/couette.svg" title="Couette flow"&gt;&lt;/p&gt;
&lt;p&gt;We therefore have three fundamental units and four parameters, meaning that
our dimensional matrix (defined in Equation \eqref{dimension_matrix})
must have three rows (one for each fundamental unit), and four columns (one for each parameter).
The entries of the matrix correspond to the exponent of that row's unit in that column's parameter.
We order the units &lt;span class="math"&gt;\(kg\)&lt;/span&gt;, &lt;span class="math"&gt;\(m\)&lt;/span&gt;, and &lt;span class="math"&gt;\(s\)&lt;/span&gt;, and order the parameters &lt;span class="math"&gt;\(\eta\)&lt;/span&gt;, &lt;span class="math"&gt;\(\rho\)&lt;/span&gt;, &lt;span class="math"&gt;\(D\)&lt;/span&gt;, and &lt;span class="math"&gt;\(u_0\)&lt;/span&gt;,
allowing us to construct the matrix:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\bar{\bar{\gamma}} = 
\begin{bmatrix}
1 &amp;amp; 1 &amp;amp; 0 &amp;amp; 0 \\\\
-1 &amp;amp; -3 &amp;amp; 1 &amp;amp; 1 \\\\
-1 &amp;amp; 0 &amp;amp; 0 &amp;amp; -1 \\\\
\end{bmatrix}
\end{equation}&lt;/div&gt;
&lt;p&gt;I won't solve it here, but this 3x4 matrix has exactly one vector in its nullspace, which is given by&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\bar{\pi} =
\begin{bmatrix}
-1 \\\\
1 \\\\
1 \\\\
1 \\\\
\end{bmatrix}
\end{equation}&lt;/div&gt;
&lt;p&gt;You can verify that this does indeed make the zero vector when you apply &lt;span class="math"&gt;\(\bar{\bar{\gamma}}\)&lt;/span&gt; to it.
This vector &lt;span class="math"&gt;\(\bar{\pi}\)&lt;/span&gt; can be converted back into its symbolic unit description:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{\rho u_0 D}{\eta}
\end{equation}&lt;/div&gt;
&lt;p&gt;This, you may not be surprised to see, is the nondimensional number associated with
Couette flow, the Reynolds number!&lt;/p&gt;
&lt;p&gt;To summarize, we have seen that the problem of dimensional analysis, which we 
described in some detail in the previous two articles, can be written
equivalently in terms of matrix-vector operations. This allows us 
to bring the whole edifice of linear algebra to bear on the problem.
It also suggests an interesting possibility: since computers are &lt;em&gt;extremely&lt;/em&gt;
good at linear algebra, it should be possible to write some 
code that does dimensional analysis for us, with a minimum of 
effort on our part. That is what I will be attempting in my &lt;a href="automated-dimensional-analysis.html"&gt;next article&lt;/a&gt;.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Nondimensional numbers and the Buckingham Pi theorem</title><link href="/nondimensional-numbers-and-the-buckingham-pi-theorem.html" rel="alternate"></link><published>2015-09-21T00:00:00-07:00</published><updated>2015-09-21T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2015-09-21:/nondimensional-numbers-and-the-buckingham-pi-theorem.html</id><summary type="html">&lt;p&gt;&lt;img alt="kanagawa" src="/articles/dimensional_analysis/images/kanagawa.jpg"&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;In my &lt;a href="introduction-to-dimensional-analysis.html"&gt;previous post&lt;/a&gt; I 
tried to establish the context for nondimensional analysis, which 
allowed us to ask the central questions that the Buckingham Pi theorem
will allow us to answer. At the heart of the matter was the relationship
between the units of the physical parameters which are important for a given problem,
and the units of the quantity which we are trying to determine.&lt;/p&gt;
&lt;p&gt;For the example of the period of the pendulum in a grandfather clock,
we surmised that the important parameters were the length of the pendulum &lt;span class="math"&gt;\(L\)&lt;/span&gt;,
the mass of the bob &lt;span class="math"&gt;\(M\)&lt;/span&gt;, and the acceleration due to gravity &lt;span class="math"&gt;\(g\)&lt;/span&gt;.
When we tried to come up with something that matched the units of the period (seconds),
we found that there was only one way to do that:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
T \sim \sqrt{\frac{L}{g}}
\label{period}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Since there was only one way to make something with the right units,
we were pretty sure that the solution to this problem would look a lot like
Equation \eqref{period}, and indeed that was correct, up to a factor of &lt;span class="math"&gt;\(2 \pi\)&lt;/span&gt;.&lt;/p&gt;
&lt;h2&gt;Couette flow&lt;/h2&gt;
&lt;p&gt;It is not always the case that there is only one way to make something of the correct units.
In many more complicated problems there can be several ways to rearrange the parameters to get the units we want.
A good example of this is &lt;a href="https://en.wikipedia.org/wiki/Couette_flow"&gt;Couette flow&lt;/a&gt;,
which is among the simpler classical fluid dynamics problems, but still exhibits
a huge amount of richness and complexity, and research on this style of flow is still being done.&lt;/p&gt;
&lt;p&gt;In Couette flow there are two parallel plates with a fluid between them.
The fluid has a viscosity &lt;span class="math"&gt;\(\eta \; (\mathrm{kg}/\mathrm{m s})\)&lt;/span&gt; and a density &lt;span class="math"&gt;\(\rho \; (\mathrm{kg}/\mathrm{m}^3)\)&lt;/span&gt;,
and the plates are separated by a distance &lt;span class="math"&gt;\(D \; (\mathrm{m})\)&lt;/span&gt;. The top plate is 
being moved in the &lt;span class="math"&gt;\(x\)&lt;/span&gt;-direction at velocity &lt;span class="math"&gt;\(u_0 \; (\mathrm{m/s})\)&lt;/span&gt;. We presume
that the plates are large enough laterally that we can neglect their edges.&lt;/p&gt;
&lt;p&gt;&lt;img alt="couette" src="/articles/dimensional_analysis/images/couette.svg" title="Couette flow"&gt;&lt;/p&gt;
&lt;p&gt;We are interested in determining the velocity and pressure in the 
fluid, which means that, in general, you have to solve 
the Navier-Stokes equations for an incompressible fluid:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\rho \frac{D \mathbf{u}}{Dt} = -\nabla P + \eta \nabla^2 \mathbf{u}
\end{equation}&lt;/div&gt;
&lt;div class="math"&gt;\begin{equation}
\nabla \cdot \mathbf{u} = 0
\end{equation}&lt;/div&gt;
&lt;p&gt;The Navier-Stokes equations are notoriously difficult to solve:
there is a rather &lt;a href="http://www.claymath.org/millennium-problems/navier%E2%80%93stokes-equation"&gt;large prize&lt;/a&gt;
available to anybody able to make some foundational progress towards a general solution.
How much can we learn about this system from a dimensional standpoint?&lt;/p&gt;
&lt;p&gt;Well, let's do the same accounting we did for the pendulum problem. We would like to
know the velocity of the fluid between the plates, and the relevant parameters 
for the problem are the fluid viscosity &lt;span class="math"&gt;\(\eta\)&lt;/span&gt;, the fluid density &lt;span class="math"&gt;\(\rho\)&lt;/span&gt;, the distance
between the two plates &lt;span class="math"&gt;\(D\)&lt;/span&gt;, and the velocity of the upper plate &lt;span class="math"&gt;\(u_0\)&lt;/span&gt;. which is driving 
the fluid flow. How can we use those to make something with units of velocity (&lt;span class="math"&gt;\(\mathrm{m/s}\)&lt;/span&gt;)?&lt;/p&gt;
&lt;p&gt;You might think at first that this is easier than the pendulum problem. The driving 
velocity &lt;span class="math"&gt;\(u_0\)&lt;/span&gt; has the right units, so we are already done!
A closer look, though, reveals another way to make something of the right units:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\frac{\eta}{\rho D}
\end{equation}&lt;/div&gt;
&lt;p&gt;There are, in fact, two different ways to represent the units of the velocity &lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt;.
We can look at this system as having two different velocity "scales," of a sort.
There is the scale which is determined by the driving velocity &lt;span class="math"&gt;\(u_0\)&lt;/span&gt;, but there 
is also the scale which is determined by the properties of the fluid and the 
geometry of the setup &lt;span class="math"&gt;\(\eta/\rho D\)&lt;/span&gt;. So which one is the correct scale? 
Which one is more appropriate for trying to learn about the velocity of the fluid?&lt;/p&gt;
&lt;p&gt;The answer, you may not be surprised to learn, is that both are important.
Moreover, the most useful way of looking at this problem is to compare 
the relative size of these two different fluid velocity scales.
How the fluid behaves is determined by this comparison: if the driving velocity is
much larger than the natural fluid velocity scale, the Couette flow 
will look very different than if the driving velocity is much smaller than the fluid velocity scale.&lt;/p&gt;
&lt;p&gt;We can express this comparison mathematically by calculating the ratio of the two velocity scales.
In fact, this ratio is so important for the Couette flow setup (and others like it)
that it goes by a special name, the Reynolds number:&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\mathrm{Re} = \frac{\rho u_0 D}{\eta}
\end{equation}&lt;/div&gt;
&lt;p&gt;The Reynolds number has a nice physical interpretation: it represents the 
relative importance of the inertia of the fluid (which is driven by
the wall motion, and tends to keep the fluid moving) and the viscous 
forces in the fluid (which tend to damp out fluid motions).
If the Reynolds is large, inertia is more important, and the 
fluid will have whorls, vortices, and be very chaotic.&lt;/p&gt;
&lt;p&gt;&lt;img alt="kanagawa" src="/articles/dimensional_analysis/images/kanagawa.jpg" title="A high Reynolds number fluid (the waves, not the boats)"&gt;&lt;/p&gt;
&lt;p&gt;If the Reynolds number is small, the fluid will move slowly
and regularly, in a fashion that is known as "laminar."&lt;/p&gt;
&lt;p&gt;&lt;img alt="honey" src="/articles/dimensional_analysis/images/honey.jpg" title="A low Reynolds number fluid (the honey, not the stick)"&gt;&lt;/p&gt;
&lt;h2&gt;Nondimensional numbers&lt;/h2&gt;
&lt;p&gt;Something very important happened when we compared the two velocity scales
by computing the Reynolds number: we divided something with units of velocity
by something with units of velocity. By doing so we canceled out all the units 
in the number: we could compute the Reynolds number by measuring velocity 
in meters per second, we could compute it using feet per hour, we could compute 
it using light years per fortnight, and we would always come up with the same
Reynolds number. And that Reynolds number will still have the 
physical interpretation of inertial-to-viscous effects.&lt;/p&gt;
&lt;p&gt;Circling back to our initial goal of characterizing the velocity solution 
in terms of our parameters, we found that we can represent the units 
correctly by doing either of the following:
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\mathbf{u} \sim u_0
\end{equation}&lt;/div&gt;
&lt;div class="math"&gt;\begin{equation}
\mathbf{u} \sim \frac{\eta}{\rho D}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Unlike the pendulum example, there is an additional wrinkle.
Sure, those expressions correctly represent the units of velocity,
but we can multiply the right hand sides by the Reynolds number, 
which has no dimensions, and still get the correct units.
Even more, we can multiply by &lt;em&gt;any arbitrary function of 
the Reynolds number&lt;/em&gt;, and have no effect on the units.&lt;/p&gt;
&lt;p&gt;Expressed in terms of an equation, we can write 
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
\mathbf{u} = u_0 \; f( \mathrm{Re} )
\label{u_0_dimensions}
\end{equation}&lt;/div&gt;
&lt;div class="math"&gt;\begin{equation}
\mathbf{u} = \frac{\eta}{\rho D} \; g( \mathrm{Re} )
\end{equation}&lt;/div&gt;
&lt;p&gt;
Which expression is more correct? For the most part, it does not matter.
It is not hard to show from the above equations that
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
g(\mathrm{Re}) = \mathrm{Re} \; f(\mathrm{Re})
\end{equation}&lt;/div&gt;
&lt;p&gt;
so these two expressions are really just different ways of writing the same thing.
And furthermore, that thing is not just a curiosity.
We now know that every form of the solution for the velocity field &lt;span class="math"&gt;\(\mathbf{u}\)&lt;/span&gt;
can be written like Equation \ref{u_0_dimensions}, since that is the only way
to make the units work out right. Therefore, every form of the solution
&lt;em&gt;must be expressible in terms of the Reynolds number&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;The Reynolds number is, in a sense, the most natural way to describe Couette flow:
it tells us something about the physics of the setup and it does not depend 
on the system of units that we have chosen for our measurements. Even better,
now we know that the system is expressible using a single parameter (&lt;span class="math"&gt;\(\mathrm{Re}\)&lt;/span&gt;),
as opposed to the four parameters we started out with (&lt;span class="math"&gt;\(\rho\)&lt;/span&gt;, &lt;span class="math"&gt;\(u_0\)&lt;/span&gt;, &lt;span class="math"&gt;\(D\)&lt;/span&gt;, and &lt;span class="math"&gt;\(\eta\)&lt;/span&gt;). 
That can potentially give us a huge savings of effort: instead of trying to understand how 
Couette flow works if we change around the four parameters, we now know that we only 
have to explore how things work if we change the Reynolds number.&lt;/p&gt;
&lt;p&gt;It is beyond the scope of this article, but there is a large literature 
on Couette flow and how it behaves at different Reynolds numbers.
At low &lt;span class="math"&gt;\(\mathrm{Re}\)&lt;/span&gt; it is laminar, which is shown in the above schematic diagram.
As &lt;span class="math"&gt;\(\mathrm{Re}\)&lt;/span&gt; becomes larger, however, instabilities in the flow start to 
appear, causing complex and turbulent flow features.&lt;/p&gt;
&lt;h2&gt;The Buckingham Pi theorem&lt;/h2&gt;
&lt;p&gt;&lt;img alt="pie" src="/articles/dimensional_analysis/images/pie.jpg" title="A low-rent pun. It probably won't be the last"&gt;&lt;/p&gt;
&lt;p&gt;Let's try to put the observations we've made so far into a coherent picture.
When working out the period of a pendulum, there was only one way to make something 
with the right units. However, when we tried a more complicated problem in Couette flow,
which has more parameters in it, there were two ways to make something with the right units.
This redundancy meant that we were able to construct a nondimensional number, and resulting 
solutions could include arbitrary functions of this nondimensional number.&lt;/p&gt;
&lt;p&gt;It seems to be a general feature of dimensional analysis that as we add more parameters 
which are important to the problem, there start to be more ways that we can represent 
any given units. Furthermore, if we can represent a given unit in several ways, we should
be able to construct several nondimensional numbers out of those ways, just as we did with the Reynolds number.&lt;/p&gt;
&lt;p&gt;The Buckingham Pi theorem allows us to be quantitative about this observation:
given a set of parameters, it tells you how many "ways" you can make a unit,
and how many nondimensional numbers can be constructed out of those parameters.&lt;/p&gt;
&lt;p&gt;The basic procedure for the Buckingham Pi theorem is as follows:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;First, we count the number of fundamental units in the problem.
These are units which are not built out of other units, things like mass: time, or length.
Density would not qualify, as it is built out of mass and length units (&lt;span class="math"&gt;\(\mathrm{kg}/\mathrm{m}^3\)&lt;/span&gt;).
Call that number of fundamental units &lt;span class="math"&gt;\(k\)&lt;/span&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Second, we count the number of parameters in the problem. Call that number &lt;span class="math"&gt;\(n\)&lt;/span&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;The number of nondimensional numbers is then given by &lt;span class="math"&gt;\(p = n-k\)&lt;/span&gt;. We can express
any solution to the problem in terms of those &lt;span class="math"&gt;\(p\)&lt;/span&gt; nondimensional numbers.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Let's apply this procedure two our two example problems:&lt;/p&gt;
&lt;p&gt;The pendulum problem had the paramters &lt;span class="math"&gt;\(L\)&lt;/span&gt; and &lt;span class="math"&gt;\(g\)&lt;/span&gt;, so &lt;span class="math"&gt;\(n=2\)&lt;/span&gt;.
The fundamental units in the problem are length and time, so &lt;span class="math"&gt;\(k=2\)&lt;/span&gt;.
Therefore, the number of nondimensional numbers is 
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
p=2-2=0
\end{equation}&lt;/div&gt;
&lt;p&gt;
Very complicated math. But it confirms what we found before, that there
are no ways to make any nondimensional numbers, and therefore only
one way to represent the units of the pendulum's period (the astute reader
may wonder what would have happened if we included the mass of the bob in our
parameter list, as we mistakenly did earlier: I hope to get to that later!).&lt;/p&gt;
&lt;p&gt;The Couette flow problem had the parameters &lt;span class="math"&gt;\(\eta\)&lt;/span&gt;, &lt;span class="math"&gt;\(\rho\)&lt;/span&gt;, &lt;span class="math"&gt;\(D\)&lt;/span&gt;, and &lt;span class="math"&gt;\(u_0\)&lt;/span&gt;, so &lt;span class="math"&gt;\(n=4\)&lt;/span&gt;.
The fundamental units in that problem were mass, time, and length, so &lt;span class="math"&gt;\(k = 3\)&lt;/span&gt;.
Therefore we can calculate the number of nondimensional numbers as 
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
p=4-3=1
\end{equation}&lt;/div&gt;
&lt;p&gt;
Again, this is consistent with our discovery of a single nondimensional number: the Reynolds number.&lt;/p&gt;
&lt;p&gt;You may notice that the description of the Buckingham Pi theorem above
is essentially the same as the quote from the Wikipedia article in the previous post. 
Hopefully it should make more sense this time around. 
However, it still may not be clear why it is true.
The answer is that the Buckingham Pi theorem is, at heart,
an application of the most important result in linear algebra: the rank-nullity theorem.
In my &lt;a href="linear-algebra-and-the-buckingham-pi-theorem.html"&gt;next post&lt;/a&gt;, I will revisit the theorem from that perspective.&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Introduction to dimensional analysis</title><link href="/introduction-to-dimensional-analysis.html" rel="alternate"></link><published>2015-09-08T00:00:00-07:00</published><updated>2015-09-08T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2015-09-08:/introduction-to-dimensional-analysis.html</id><summary type="html">&lt;p&gt;&lt;img alt="apple_plus_orange" src="/articles/dimensional_analysis/images/apple_plus_orange.jpeg"&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;This is the beginning of what I intend to be a multi-part series on dimensional analysis.
The goal for this post is to set the stage for why dimensional analysis is a powerful tool,
and to ask the questions which will lead us to the Buckingham Pi theorem.&lt;/p&gt;
&lt;p&gt;The Buckingham Pi theorem is probably the most important result in the field of dimensional analysis.
That being said, many descriptions of the theorem leave something to be desired, and when 
I used to read them I would come away as confused as when I started.&lt;br&gt;
The &lt;a href="https://en.wikipedia.org/wiki/Buckingham_%CF%80_theorem"&gt;Wikipedia article&lt;/a&gt; on the topic describes it thusly:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;...if there is a physically meaningful equation involving a certain number &lt;span class="math"&gt;\(n\)&lt;/span&gt; of physical variables, 
then the original equation can be rewritten in terms of a set of &lt;span class="math"&gt;\(p = n  k\)&lt;/span&gt;  dimensionless parameters 
&lt;span class="math"&gt;\(\pi_1\)&lt;/span&gt;, &lt;span class="math"&gt;\(\pi_2\)&lt;/span&gt;, ..., &lt;span class="math"&gt;\(\pi_p\)&lt;/span&gt; constructed from the original variables. (Here &lt;span class="math"&gt;\(k\)&lt;/span&gt; is the number of 
physical dimensions involved; it is obtained as the rank of a particular matrix.)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;This is a true statement, but it is essentially the punchline of the theorem. Without the 
context for what &lt;span class="math"&gt;\(p\)&lt;/span&gt;, &lt;span class="math"&gt;\(n\)&lt;/span&gt;, and &lt;span class="math"&gt;\(k\)&lt;/span&gt; are, how they relate to the &lt;span class="math"&gt;\(\pi_p\)&lt;/span&gt;, and why we care 
about any of it, it is very difficult to understand.&lt;/p&gt;
&lt;p&gt;I would like to develop some of that context, and to begin we will ask what is meant by 
dimensional analysis in the first place. A lot of what follows will be similar to first-rate 
treatements of dimensional analysis by &lt;a href="https://archive.org/details/dimensionalanaly00bridrich"&gt;Percy Bridgman&lt;/a&gt; 
and by &lt;a href="http://www.cambridge.org/us/academic/subjects/mathematics/mathematical-modelling-and-methods/scaling?format=PB"&gt;G.I. Barenblatt&lt;/a&gt;.
Both of these (short) books are excellent, and I have shamelessly borrowed from them.
As an aside, Bridgman was a physicist at Harvard who did foundational work on high pressure 
physics and materials science. Recently the most abundant mineral on Earth (in Earth?),
&lt;a href="https://en.wikipedia.org/wiki/Silicate_perovskite"&gt;bridgmanite&lt;/a&gt;, was named in his honor.&lt;/p&gt;
&lt;h2&gt;Physical equations&lt;/h2&gt;
&lt;p&gt;Central to dimensional analysis is the concept of a physical equation. 
A physical equation is something which is has the following properties:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It involves an equals sign (&lt;span class="math"&gt;\(=\)&lt;/span&gt;).&lt;/li&gt;
&lt;li&gt;All the terms in the equation have physical dimensions.&lt;/li&gt;
&lt;li&gt;The physical dimensions of these terms are the same.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;The first point simply tells us we are dealing with equations, and the second part 
tells us that we are dealing with equations regarding measurable things in the reals world.
This may sound trivial, but we will see that many of the statements in dimensional analysis
which sound trivial are, in fact, quite slippery. When a quantity has physical dimensions it 
means that there is some standard that we have agreed upon to measure that quantity. We then can 
determine any quantity of that type in multiples of the standard. This is quite abstract, 
but it means that we can, for instance, define a &lt;a href="https://en.wikipedia.org/wiki/Kilogram"&gt;standard kilogram&lt;/a&gt;,
and then measure the mass of any item by determining how many of that standard have 
an equal mass to the item.&lt;/p&gt;
&lt;p&gt;&lt;img alt="kilogram" src="articles/dimensional_analysis/images/standard_kilogram.jpg" title="The standard kilogram"&gt;&lt;/p&gt;
&lt;p&gt;As another example, the initial definition of the meter had it as one ten-millionth 
of the distance from the equator to the north pole. With that definition, anybody could
(at least in principle), construct a meter-stick and measure the lengths of things to 
their hearts content.&lt;/p&gt;
&lt;p&gt;Okay, so this standardization of units is all well and good, but at the end of the day, the natural world 
should not care at all what system of units we use for measuring things. There is nothing 
special about one ten-millionth of one-fourth of the circumference of Earth
(except, perhaps, when performing navigation or geography). 
Since the choice of unit is arbitrary, we should be able to convert from one 
system of units to another. For instance, if we are measuring length in inches, we can 
convert to centimeters by multiplying our values in inches by 2.54.&lt;/p&gt;
&lt;p&gt;This gets us to the third point in the above list. 
In a physical equation, both sides of the equation must have the same units.
People who have some physics background may find this statement to be obvious, 
but when pressed, they may also have a hard time expressing why it has to be so.
To others it may not even make sense. Unfortunately, some fairly 
&lt;a href="https://en.wikipedia.org/wiki/Free_abelian_group"&gt;deep mathematics&lt;/a&gt; is involved,
most of which I am not really qualified to address, so I will proceed with an example.&lt;/p&gt;
&lt;p&gt;A common example given for why the units in a physical equation must match is something 
along the lines of "you can't add apples and oranges!" &lt;/p&gt;
&lt;p&gt;&lt;img alt="apple_plus_orange" src="articles/dimensional_analysis/images/apple_plus_orange.jpeg" title="Was this worth my time? Probably not..."&gt;&lt;/p&gt;
&lt;p&gt;This is kind of an unfortunate argument, since there are conceivably situations 
where it makes perfect sense to add apples and oranges. What if I am trying to 
organize a school lunch program, and there are bushels (how's that for a unit?) 
of apples and oranges in the cafeteria? How many pieces of fruit do I have to 
distribute? I challenge you to figure it out without adding apples and oranges.&lt;/p&gt;
&lt;p&gt;So we are going to try a more extreme example. What would it mean to to have an equation
that added minutes and meters which combined to make a new unit, say minumeters? 
Something along the lines of&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
x \; \mathrm{minutes} + y \; \mathrm{meters} = z \; \mathrm{minumeters}
\label{minumeters}
\end{equation}&lt;/div&gt;
&lt;p&gt;However, we know that physics should not care about the units that we choose,
so what happens if we want to use seconds, feet, and a new (fictitious) unit, feeconds?
Well, we know that we can convert meters to feet by multiplying by ~3.3 
(the number of feet in a meter), and we can convert minutes to seconds by multiplying 
by 60 (the number of seconds in a minute). 
Furthermore, since we presume minutmeters and feeconds to be valid units, there should 
be a scale to convert them between each other (both being the result of adding length and time together),
which we denote by &lt;span class="math"&gt;\(s\)&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;So we should be able to convert Equation \eqref{minumeters} to feeconds by 
scaling all the terms in it appropriately: 
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
60 x \; \mathrm{seconds} + 3.3 y \; \mathrm{feet} = s\;z \;\mathrm{feeconds}
\label{feeconds}
\end{equation}&lt;/div&gt;
&lt;p&gt;Here is where we run into trouble. Inspecting Equations \eqref{minumeters} and
\eqref{feeconds}, we begin to see that the unit conversion on the left hand side
is not a simple scaling operation. Indeed, there is no single value for &lt;span class="math"&gt;\(s\)&lt;/span&gt; which 
can satisfy Equation \eqref{feeconds} for all values of &lt;span class="math"&gt;\(x\)&lt;/span&gt; and &lt;span class="math"&gt;\(y\)&lt;/span&gt; (give it a shot!).&lt;/p&gt;
&lt;p&gt;We have arrived at a contradictory result, so there must have been a problem somewhere
in the analysis. This problem, of course, is that we should not have added quantites
of different dimensions. Do that, and you quickly run afoul the "physics does not care
about our choice of measures" rule.&lt;/p&gt;
&lt;h2&gt;Example: a simple pendulum&lt;/h2&gt;
&lt;p&gt;The requirement that all the terms of the equation have the same units is actually stronger 
than it may seem at first, and it lies at the heart of dimensional analysis. 
If we have a physical system that we are trying to understand, it likely has some parameters which characterize it.
Any physical equation that we cook up must satisfy the rules of dimensional analysis, and therefore 
the parameters have to be combined in such a way that they have the right units. 
Any other combination of these parameters has to be nonsense.&lt;/p&gt;
&lt;p&gt;For instance, let us say that we are trying to understand how the pendulum in a grandfather clock works.
It does a very good job of marking time, and it occurs to us that somebody has 
designed the pendulum so that its period is exactly one second.
We decide to figure out what sets the period (&lt;span class="math"&gt;\(T\)&lt;/span&gt;) of the pendulum.
&lt;img alt="clock" src="images/grandfather_clock.jpg" title="It felt like there was a lot of text, here is a clock!"&gt;
After studying the clock for a few minutes, we decide that the most important parameters 
must be the mass (&lt;span class="math"&gt;\(M\)&lt;/span&gt;) of the bob, which makes it swing back and forth, and the length (&lt;span class="math"&gt;\(L\)&lt;/span&gt;) of the pendulum.
Therefore, we begin looking for an equation that relates the period to the mass and length, or 
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
T = f( M, L )
\label{incorrect-period}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Seems simple enough.  But as soon as we look at the units, we run into a problem.
The unit of &lt;span class="math"&gt;\(T\)&lt;/span&gt; is seconds, the unit of &lt;span class="math"&gt;\(M\)&lt;/span&gt; is kilograms, and the unit of &lt;span class="math"&gt;\(L\)&lt;/span&gt; is meters.
There is simply no way to combine the parameters &lt;span class="math"&gt;\(M\)&lt;/span&gt; and &lt;span class="math"&gt;\(L\)&lt;/span&gt; to make something in seconds,
so you cannot actually find a relation like \eqref{incorrect-period}.&lt;/p&gt;
&lt;p&gt;So what was our mistake? Well, it turns out that our accounting of the important parameters missed one.
A pendulum also needs gravity, otherwise there is no reason for it to swing back towards the ground.
Therefore we add the acceleration due to gravity &lt;span class="math"&gt;\(g\)&lt;/span&gt; to our list of parameters, which has units of  &lt;span class="math"&gt;\(m/s^2\)&lt;/span&gt;.
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
T = f( M, L, g )
\label{correct-period}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Now we have a parameter that has seconds as a component, so it may be possible to combine the units 
to match the units of the period &lt;span class="math"&gt;\(T\)&lt;/span&gt;.
Indeed, after some playing around, we figure out that there is really only one way to combine 
the units to make seconds, which is to say
&lt;/p&gt;
&lt;div class="math"&gt;\begin{equation}
T \sim \sqrt{ \frac{L}{g} }
\label{period}
\end{equation}&lt;/div&gt;
&lt;p&gt;
Not only is this the only way to make something with units of seconds, but there is no place for the mass of the bob on the pendulum. 
This turns out to be correct: for simple pendula, the mass is irrelevant: only gravity and the length matter.
Now, the &lt;a href="https://en.wikipedia.org/wiki/Pendulum_%28mathematics%29#Simple_gravity_pendulum"&gt;full formula&lt;/a&gt;
for the period of a simple pendulum has a factor of &lt;span class="math"&gt;\(2\pi\)&lt;/span&gt;, so we were 
not 100% correct, but we got pretty close, and we captured the essential physics of the pendulum without 
actually solving any equations. Instead, all we considered were the dimensions of the thing we were looking for,
and the dimensions of the parameters.&lt;/p&gt;
&lt;h2&gt;Asking the right questions&lt;/h2&gt;
&lt;p&gt;So all this is well and good, but the initial guess about the relevant parameters forgot about gravity, 
and it included a superfluous parameter. We had to play around with the parameters a bit in order to figure 
out how to combine them in the correct way. And even then, it is not necessarily obvious that there is only 
one correct way to combine them.
It would be nice to have a way to go about this more systematic and rigorous way.&lt;/p&gt;
&lt;p&gt;We now have the context to ask more specific questions.
Given a system to study and some relevant paramters, we want to answer:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Can these parameters represent the physics we are interested in?&lt;/li&gt;
&lt;li&gt;How many ways can we combine them to get the correct units?&lt;/li&gt;
&lt;li&gt;What are allowable functional forms of the solution according to the rules of dimensional analysis? &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are the fundamental questions of dimensional analysis: 
questions which are more or less answered by the Buckingham Pi theorem.
Along the way we will encounter nondimensional numbers, which turn out to be, in a sense,
the most natural system of units to represent the physics of the system.
And hopefully at the end we will be able to go back to the above Wikipedia quote and understand what it means.&lt;/p&gt;
&lt;p&gt;In my &lt;a href="nondimensional-numbers-and-the-buckingham-pi-theorem.html"&gt;next post&lt;/a&gt;,
I will be taking a qualitative look at the content of the Buckingham Pi theorem.
&lt;img alt="new-cuayma" src="articles/dimensional_analysis/images/new-cuyama.jpg" title="My kind of place"&gt;&lt;/p&gt;
&lt;script type="text/javascript"&gt;if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width &lt; 768) ? "left" : align;
        indent = (screen.width &lt; 768) ? "0em" : indent;
        linebreak = (screen.width &lt; 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
&lt;/script&gt;</content></entry><entry><title>Introduction</title><link href="/introduction.html" rel="alternate"></link><published>2015-08-21T00:00:00-07:00</published><updated>2015-08-21T00:00:00-07:00</updated><author><name>Ian Rose</name></author><id>tag:None,2015-08-21:/introduction.html</id><summary type="html">&lt;p&gt;Welcome to the inaugural post of this blog, where I plan to write about anything that strikes me as interesting. 
For the most part these things will be related to geology, geophysics, or scientific computing.
At the moment I am titling the site "Blueschisting," with which I am not necessarily &lt;/p&gt;</summary><content type="html">&lt;p&gt;Welcome to the inaugural post of this blog, where I plan to write about anything that strikes me as interesting. 
For the most part these things will be related to geology, geophysics, or scientific computing.
At the moment I am titling the site "Blueschisting," with which I am not necessarily in love, but I could 
not think of something better when setting things up. At the very least it does not appear to be taken.&lt;/p&gt;
&lt;p&gt;Overall it is my hope that this blog will accomplish these three things, in no particular order:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Get me to write more often and with less friction.&lt;/li&gt;
&lt;li&gt;Provide a place to record various ideas, derivations, and perspectives so that I can refer to them later.&lt;/li&gt;
&lt;li&gt;Maybe even be of some interest to some third party (though this may not ever be the case. If somebody is reading: hello!).&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To start, I plan to write a series of posts on one of my favorite results in mathematical physics:
the Buckingham Pi theorem.&lt;/p&gt;</content></entry></feed>